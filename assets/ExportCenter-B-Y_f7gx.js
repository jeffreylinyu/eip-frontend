import{_ as I,x as S,f as r,g as i,c as N,h as e,i as c,n as x,y as D,p as f,D as b,k as d,t as a,F as g,E as v,j as u,v as C,G as F,l as h,H as P,I as y,J as V}from"./index-C6HqEDEC.js";const U={name:"ExportCenter",data(){return{activeTab:"scenario",isExporting:!1,showPreview:!1,scenarios:[{id:"acceptance-inspection",name:"工程驗收報告",description:"包含工程完工驗收所需的完整文件",icon:"fa-clipboard-check",color:"success",forms:["工程基本資料","驗收清單","品質檢查表","安全評估","財務結算"],estimatedTime:"2-3分鐘"},{id:"progress-report",name:"施工進度報告",description:"定期施工進度追蹤與管控報告",icon:"fa-chart-line",color:"info",forms:["工程基本資料","進度統計","里程碑追蹤","資源使用狀況"],estimatedTime:"1-2分鐘"},{id:"quality-control",name:"品質管制報告",description:"工程品質管控與檢測相關文件",icon:"fa-medal",color:"warning",forms:["工程基本資料","品質檢測紀錄","材料檢驗","施工品質評估"],estimatedTime:"2-4分鐘"},{id:"safety-report",name:"安全檢查報告",description:"工地安全檢查與事故預防報告",icon:"fa-hard-hat",color:"danger",forms:["工程基本資料","安全檢查清單","事故報告","安全教育訓練"],estimatedTime:"1-3分鐘"},{id:"financial-summary",name:"財務結算報告",description:"工程財務支出與結算明細",icon:"fa-calculator",color:"primary",forms:["工程基本資料","預算執行","付款明細","成本分析"],estimatedTime:"2-5分鐘"},{id:"supervision-report",name:"監造報告",description:"監造單位定期監督與檢查報告",icon:"fa-eye",color:"secondary",forms:["工程基本資料","監造日誌","缺失改善","工程查核"],estimatedTime:"3-5分鐘"}],selectedScenario:null,availableForms:[{id:"A-1",name:"工程基本資料表",category:"基本資料",required:!0},{id:"A-2",name:"營造廠商資訊表",category:"基本資料",required:!1},{id:"A-3",name:"監造單位資訊表",category:"基本資料",required:!1},{id:"B-1",name:"施工進度管制表",category:"進度管控",required:!1},{id:"B-2",name:"里程碑追蹤表",category:"進度管控",required:!1},{id:"B-3",name:"資源調配表",category:"進度管控",required:!1},{id:"C-1",name:"品質檢測紀錄表",category:"品質管制",required:!1},{id:"C-2",name:"材料檢驗報告",category:"品質管制",required:!1},{id:"C-3",name:"施工品質評估表",category:"品質管制",required:!1},{id:"D-1",name:"安全檢查清單",category:"安全管制",required:!1},{id:"D-2",name:"事故報告表",category:"安全管制",required:!1},{id:"D-3",name:"安全教育訓練記錄",category:"安全管制",required:!1},{id:"E-1",name:"預算執行表",category:"財務管理",required:!1},{id:"E-2",name:"付款明細表",category:"財務管理",required:!1},{id:"E-3",name:"成本分析報告",category:"財務管理",required:!1},{id:"F-1",name:"監造日誌",category:"監造管理",required:!1},{id:"F-2",name:"缺失改善追蹤表",category:"監造管理",required:!1},{id:"F-3",name:"工程查核表",category:"監造管理",required:!1}],selectedForms:[],searchKeyword:"",selectedCategory:"all",exportSettings:{format:"xlsx",includeCharts:!0,includeImages:!0,includeComments:!1,compress:!1,passwordProtect:!1,password:"",fileName:"",templateStyle:"standard"},exportHistory:[{id:1,fileName:"工程驗收報告_2024-01-15.xlsx",type:"情境匯出",scenario:"工程驗收報告",createTime:"2024-01-15 14:30:25",fileSize:"2.5 MB",status:"completed",downloadUrl:"#"},{id:2,fileName:"自定義表單_A1-C3_2024-01-14.pdf",type:"自定義匯出",scenario:"工程基本資料表, 施工品質評估表",createTime:"2024-01-14 09:15:42",fileSize:"1.8 MB",status:"completed",downloadUrl:"#"},{id:3,fileName:"施工進度報告_2024-01-13.docx",type:"情境匯出",scenario:"施工進度報告",createTime:"2024-01-13 16:22:18",fileSize:"3.2 MB",status:"completed",downloadUrl:"#"}],previewData:null,exportProgress:0}},computed:{projectStore(){return V()},filteredForms(){let o=this.availableForms;if(this.selectedCategory!=="all"&&(o=o.filter(t=>t.category===this.selectedCategory)),this.searchKeyword.trim()){const t=this.searchKeyword.toLowerCase();o=o.filter(m=>m.name.toLowerCase().includes(t)||m.id.toLowerCase().includes(t))}return o},formCategories(){return[...new Set(this.availableForms.map(t=>t.category))]},selectedFormsCount(){return this.selectedForms.length},canExport(){return this.activeTab==="scenario"?this.selectedScenario!==null:this.activeTab==="custom"?this.selectedForms.length>0:!1}},methods:{setActiveTab(o){this.activeTab=o,this.resetSelections()},resetSelections(){this.selectedScenario=null,this.selectedForms=[],this.searchKeyword="",this.selectedCategory="all"},selectScenario(o){this.selectedScenario=o},toggleForm(o){const t=this.selectedForms.findIndex(m=>m.id===o.id);t>-1?this.selectedForms.splice(t,1):this.selectedForms.push(o)},isFormSelected(o){return this.selectedForms.some(t=>t.id===o.id)},selectAllInCategory(){const o=this.filteredForms.filter(t=>!this.selectedForms.some(m=>m.id===t.id));this.selectedForms.push(...o)},clearCategorySelection(){const o=this.filteredForms.map(t=>t.id);this.selectedForms=this.selectedForms.filter(t=>!o.includes(t.id))},async previewExport(){this.showPreview=!0;try{await new Promise(o=>setTimeout(o,1e3)),this.activeTab==="scenario"?this.previewData={type:"scenario",title:this.selectedScenario.name,forms:this.selectedScenario.forms,totalPages:Math.floor(Math.random()*20)+10}:this.previewData={type:"custom",title:"自定義匯出",forms:this.selectedForms.map(o=>o.name),totalPages:Math.floor(Math.random()*15)+5}}catch{y.error("預覽載入失敗"),this.showPreview=!1}},async startExport(){if(!this.canExport){y.warning("請先選擇要匯出的內容");return}if(!this.exportSettings.fileName){const t=new Date().toISOString().split("T")[0];this.activeTab==="scenario"?this.exportSettings.fileName=`${this.selectedScenario.name}_${t}`:this.exportSettings.fileName=`自定義表單_${t}`}this.isExporting=!0,this.exportProgress=0;try{const o=setInterval(()=>{this.exportProgress+=Math.random()*15,this.exportProgress>=100&&(this.exportProgress=100,clearInterval(o))},200);await new Promise(m=>setTimeout(m,3e3));const t={id:this.exportHistory.length+1,fileName:`${this.exportSettings.fileName}.${this.exportSettings.format}`,type:this.activeTab==="scenario"?"情境匯出":"自定義匯出",scenario:this.activeTab==="scenario"?this.selectedScenario.name:this.selectedForms.slice(0,2).map(m=>m.name).join(", ")+(this.selectedForms.length>2?"...":""),createTime:new Date().toLocaleString("zh-TW"),fileSize:`${(Math.random()*3+1).toFixed(1)} MB`,status:"completed",downloadUrl:"#"};this.exportHistory.unshift(t),y.success(`匯出完成！檔案：${t.fileName}`),this.resetSelections()}catch{y.error("匯出失敗，請重試")}finally{this.isExporting=!1,this.exportProgress=0}},downloadHistoryFile(o){y.info(`開始下載：${o.fileName}`)},deleteHistoryItem(o){const t=this.exportHistory.findIndex(m=>m.id===o.id);t>-1&&(this.exportHistory.splice(t,1),y.success("歷史記錄已刪除"))},formatFileSize(o){return o},getStatusColor(o){return{completed:"badge border border-success text-success px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center",processing:"badge border border-warning text-warning px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center",failed:"badge border border-danger text-danger px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center"}[o]||"badge border border-secondary text-secondary px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center"}}},H={class:"row gx-4"},M={class:"col-lg-12"},A={class:"nav nav-tabs card-header-tabs",role:"tablist"},B={class:"nav-item",role:"presentation"},j={class:"nav-item",role:"presentation"},z={class:"nav-item",role:"presentation"},K={class:"badge border border-primary text-primary px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center ms-1"},L={key:0,class:"tab-pane-content"},W={class:"row"},G={class:"d-flex align-items-start mb-3"},J={class:"flex-shrink-0"},O={class:"flex-grow-1 ms-3"},Q={class:"card-title mb-1"},R={class:"card-text text-muted small"},X={class:"flex-shrink-0"},Y={key:0,class:"fa fa-check-circle text-success fs-4"},Z={class:"mb-3"},$={class:"mt-1"},ee={class:"d-flex justify-content-between align-items-center"},te={class:"text-muted"},se={key:1,class:"tab-pane-content"},le={class:"row mb-4"},oe={class:"col-lg-6"},ie={class:"input-group"},re={class:"col-lg-4"},ne=["value"],ae={class:"col-lg-2"},de={class:"btn-group w-100"},ce={key:0,class:"alert alert-info",role:"alert"},me={class:"d-flex align-items-center justify-content-between"},ue={class:"mt-2"},pe=["onClick"],fe={class:"row"},be={class:"d-flex align-items-start"},xe={class:"flex-grow-1"},ge={class:"d-flex align-items-center mb-2"},ve={class:"badge border border-secondary text-secondary px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center me-2"},ye={key:0,class:"badge border border-warning text-warning px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center me-2"},he={key:1,class:"fa fa-check-circle text-success"},we={class:"card-title mb-1"},ke={class:"text-muted"},_e={key:1,class:"text-center py-5"},Se={key:2,class:"tab-pane-content"},Ce={class:"d-flex justify-content-between align-items-center mb-4"},Fe={class:"text-muted"},Te={class:"table-responsive"},Pe={class:"table table-hover"},Ee={class:"d-flex align-items-center"},qe={class:"badge border border-secondary text-secondary px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center"},Ie={class:"text-muted"},Ne={class:""},De=["onClick","disabled"],Ve=["onClick"],Ue={key:0,class:"text-center py-5"},He={class:"row"},Me={class:"col-lg-4"},Ae={class:"mb-3"},Be={class:"mb-3"},je={class:"mb-3"},ze={class:"col-lg-4"},Ke={class:"form-check mb-2"},Le={class:"form-check mb-2"},We={class:"form-check mb-2"},Ge={class:"form-check mb-2"},Je={class:"col-lg-4"},Oe={class:"form-check mb-3"},Qe={key:0,class:"mb-3"},Re={class:"d-flex justify-content-between align-items-center mt-4 pt-3 border-top"},Xe={class:"text-muted"},Ye={key:0},Ze={key:1},$e={key:2,class:"text-warning"},et={class:"btn-group"},tt=["disabled"],st=["disabled"],lt={key:0,class:"mt-3"},ot={class:"d-flex justify-content-between align-items-center mb-2"},it={class:"progress"},rt={class:"modal-dialog modal-lg modal-dialog-centered"},nt={class:"modal-content"},at={class:"modal-header"},dt={key:0,class:"modal-body"},ct={class:"row mb-3"},mt={class:"col-6"},ut={class:"col-6"},pt={class:"mb-3"},ft={class:"mt-2"},bt={class:"border rounded p-3 bg-light"},xt={class:"list-unstyled mb-0"},gt={class:"modal-footer"};function vt(o,t,m,yt,l,n){const T=S("card-header"),w=S("card-body"),k=S("card");return i(),r(g,null,[t[70]||(t[70]=N('<div class="d-flex align-items-center mb-3" data-v-ef08b7d1><div data-v-ef08b7d1><ol class="breadcrumb" data-v-ef08b7d1><li class="breadcrumb-item" data-v-ef08b7d1><a href="javascript:;" data-v-ef08b7d1>表單生成與管理</a></li><li class="breadcrumb-item active" data-v-ef08b7d1>匯出中心</li></ol><h1 class="page-header mb-0" data-v-ef08b7d1>匯出中心</h1></div></div>',1)),e("div",H,[e("div",M,[x(k,null,{default:f(()=>[x(T,null,{default:f(()=>[e("ul",A,[e("li",B,[e("button",{class:b(["nav-link",{active:l.activeTab==="scenario"}]),onClick:t[0]||(t[0]=s=>n.setActiveTab("scenario")),type:"button"},t[23]||(t[23]=[e("i",{class:"fa fa-clipboard-list me-2"},null,-1),d(" 情境匯出 ")]),2)]),e("li",j,[e("button",{class:b(["nav-link",{active:l.activeTab==="custom"}]),onClick:t[1]||(t[1]=s=>n.setActiveTab("custom")),type:"button"},t[24]||(t[24]=[e("i",{class:"fa fa-sliders-h me-2"},null,-1),d(" 自定義匯出 ")]),2)]),e("li",z,[e("button",{class:b(["nav-link",{active:l.activeTab==="history"}]),onClick:t[2]||(t[2]=s=>n.setActiveTab("history")),type:"button"},[t[25]||(t[25]=e("i",{class:"fa fa-history me-2"},null,-1)),t[26]||(t[26]=d(" 匯出歷史 ")),e("span",K,a(l.exportHistory.length),1)],2)])])]),_:1}),x(w,null,{default:f(()=>[l.activeTab==="scenario"?(i(),r("div",L,[t[29]||(t[29]=e("div",{class:"row mb-4"},[e("div",{class:"col-lg-12"},[e("h5",{class:"mb-3"},"選擇匯出情境"),e("p",{class:"text-muted mb-4"},"根據不同的工程管理需求，選擇預設的表單組合進行匯出")])],-1)),e("div",W,[(i(!0),r(g,null,v(l.scenarios,s=>{var p;return i(),r("div",{key:s.id,class:"col-lg-6 mb-4"},[x(k,{class:b(["h-100 cursor-pointer scenario-card",{"border-theme":((p=l.selectedScenario)==null?void 0:p.id)===s.id}]),onClick:_=>n.selectScenario(s)},{default:f(()=>[x(w,null,{default:f(()=>{var _;return[e("div",G,[e("div",J,[e("div",{class:b(["widget-icon rounded",`bg-${s.color}`])},[e("i",{class:b(["fa",s.icon]),style:{color:"white"}},null,2)],2)]),e("div",O,[e("h6",Q,a(s.name),1),e("p",R,a(s.description),1)]),e("div",X,[((_=l.selectedScenario)==null?void 0:_.id)===s.id?(i(),r("i",Y)):c("",!0)])]),e("div",Z,[t[27]||(t[27]=e("small",{class:"text-muted"},"包含表單：",-1)),e("div",$,[(i(!0),r(g,null,v(s.forms,(E,q)=>(i(),r("span",{key:q,class:"badge border border-secondary text-secondary px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center me-1 mb-1"},a(E),1))),128))])]),e("div",ee,[e("small",te,[t[28]||(t[28]=e("i",{class:"fa fa-clock me-1"},null,-1)),d(" 預估時間："+a(s.estimatedTime),1)])])]}),_:2},1024)]),_:2},1032,["class","onClick"])])}),128))])])):c("",!0),l.activeTab==="custom"?(i(),r("div",se,[e("div",le,[e("div",oe,[t[31]||(t[31]=e("label",{class:"form-label"},"搜尋表單",-1)),e("div",ie,[t[30]||(t[30]=e("span",{class:"input-group-text"},[e("i",{class:"fa fa-search"})],-1)),u(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=s=>l.searchKeyword=s),placeholder:"搜尋表單名稱或編號..."},null,512),[[C,l.searchKeyword]])])]),e("div",re,[t[33]||(t[33]=e("label",{class:"form-label"},"表單分類",-1)),u(e("select",{class:"form-select","onUpdate:modelValue":t[4]||(t[4]=s=>l.selectedCategory=s)},[t[32]||(t[32]=e("option",{value:"all"},"全部分類",-1)),(i(!0),r(g,null,v(n.formCategories,s=>(i(),r("option",{key:s,value:s},a(s),9,ne))),128))],512),[[F,l.selectedCategory]])]),e("div",ae,[t[34]||(t[34]=e("label",{class:"form-label"},"批量操作",-1)),e("div",de,[e("button",{type:"button",class:"btn btn-outline-theme btn-sm",onClick:t[5]||(t[5]=(...s)=>n.selectAllInCategory&&n.selectAllInCategory(...s))}," 全選 "),e("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:t[6]||(t[6]=(...s)=>n.clearCategorySelection&&n.clearCategorySelection(...s))}," 清除 ")])])]),n.selectedFormsCount>0?(i(),r("div",ce,[e("div",me,[e("div",null,[t[35]||(t[35]=e("i",{class:"fa fa-info-circle me-2"},null,-1)),t[36]||(t[36]=d(" 已選擇 ")),e("strong",null,a(n.selectedFormsCount),1),t[37]||(t[37]=d(" 個表單 "))]),e("button",{type:"button",class:"btn btn-sm btn-outline-secondary",onClick:t[7]||(t[7]=s=>l.selectedForms=[])}," 清除全部 ")]),e("div",ue,[(i(!0),r(g,null,v(l.selectedForms,s=>(i(),r("span",{key:s.id,class:"badge border border-primary text-primary px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center me-1 mb-1"},[d(a(s.id)+" - "+a(s.name)+" ",1),e("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:p=>n.toggleForm(s),style:{"font-size":"0.6rem"}},null,8,pe)]))),128))])])):c("",!0),e("div",fe,[(i(!0),r(g,null,v(n.filteredForms,s=>(i(),r("div",{key:s.id,class:"col-lg-6 col-xl-4 mb-3"},[x(k,{class:b(["h-100 cursor-pointer form-card",{"border-theme":n.isFormSelected(s),"border-warning":s.required}]),onClick:p=>n.toggleForm(s)},{default:f(()=>[x(w,{class:"p-3"},{default:f(()=>[e("div",be,[e("div",xe,[e("div",ge,[e("span",ve,a(s.id),1),s.required?(i(),r("span",ye," 必選 ")):c("",!0),n.isFormSelected(s)?(i(),r("i",he)):c("",!0)]),e("h6",we,a(s.name),1),e("small",ke,a(s.category),1)])])]),_:2},1024)]),_:2},1032,["class","onClick"])]))),128))]),n.filteredForms.length===0?(i(),r("div",_e,t[38]||(t[38]=[e("i",{class:"fa fa-search fa-3x text-muted mb-3"},null,-1),e("h5",{class:"text-muted"},"找不到符合條件的表單",-1),e("p",{class:"text-muted"},"請嘗試調整搜尋條件或分類篩選",-1)]))):c("",!0)])):c("",!0),l.activeTab==="history"?(i(),r("div",Se,[e("div",Ce,[t[39]||(t[39]=e("h5",{class:"mb-0"},"匯出歷史記錄",-1)),e("div",Fe," 共 "+a(l.exportHistory.length)+" 筆記錄 ",1)]),e("div",Te,[e("table",Pe,[t[43]||(t[43]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"檔案名稱"),e("th",null,"匯出類型"),e("th",null,"包含內容"),e("th",null,"建立時間"),e("th",null,"檔案大小"),e("th",null,"狀態"),e("th",null,"操作")])],-1)),e("tbody",null,[(i(!0),r(g,null,v(l.exportHistory,s=>(i(),r("tr",{key:s.id},[e("td",null,[e("div",Ee,[t[40]||(t[40]=e("i",{class:"fa fa-file-alt me-2 text-muted"},null,-1)),e("strong",null,a(s.fileName),1)])]),e("td",null,[e("span",qe,a(s.type),1)]),e("td",null,[e("small",Ie,a(s.scenario),1)]),e("td",null,[e("small",null,a(s.createTime),1)]),e("td",null,[e("small",null,a(s.fileSize),1)]),e("td",null,[e("span",{class:b(n.getStatusColor(s.status))},a(s.status==="completed"?"已完成":s.status),3)]),e("td",null,[e("div",Ne,[e("button",{type:"button",class:"btn btn-sm btn-outline-theme me-1",onClick:p=>n.downloadHistoryFile(s),disabled:s.status!=="completed"},t[41]||(t[41]=[e("i",{class:"fa fa-download"},null,-1)]),8,De),e("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:p=>n.deleteHistoryItem(s)},t[42]||(t[42]=[e("i",{class:"fa fa-trash"},null,-1)]),8,Ve)])])]))),128))])])]),l.exportHistory.length===0?(i(),r("div",Ue,t[44]||(t[44]=[e("i",{class:"fa fa-history fa-3x text-muted mb-3"},null,-1),e("h5",{class:"text-muted"},"尚無匯出歷史",-1),e("p",{class:"text-muted"},"開始使用匯出功能後，歷史記錄將顯示在這裡",-1)]))):c("",!0)])):c("",!0)]),_:1})]),_:1}),l.activeTab!=="history"?(i(),D(k,{key:0,class:"mt-4"},{default:f(()=>[x(T,null,{default:f(()=>t[45]||(t[45]=[e("h5",{class:"mb-0"},"匯出設定",-1)])),_:1,__:[45]}),x(w,null,{default:f(()=>[e("div",He,[e("div",Me,[t[51]||(t[51]=e("h6",{class:"mb-3"},"基本設定",-1)),e("div",Ae,[t[47]||(t[47]=e("label",{class:"form-label"},"匯出格式",-1)),u(e("select",{class:"form-select","onUpdate:modelValue":t[8]||(t[8]=s=>l.exportSettings.format=s)},t[46]||(t[46]=[e("option",{value:"xlsx"},"Excel 檔案 (.xlsx)",-1),e("option",{value:"pdf"},"PDF 文件 (.pdf)",-1),e("option",{value:"docx"},"Word 文件 (.docx)",-1),e("option",{value:"csv"},"CSV 檔案 (.csv)",-1)]),512),[[F,l.exportSettings.format]])]),e("div",Be,[t[48]||(t[48]=e("label",{class:"form-label"},"檔案名稱",-1)),u(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[9]||(t[9]=s=>l.exportSettings.fileName=s),placeholder:"系統將自動生成檔名"},null,512),[[C,l.exportSettings.fileName]])]),e("div",je,[t[50]||(t[50]=e("label",{class:"form-label"},"樣板風格",-1)),u(e("select",{class:"form-select","onUpdate:modelValue":t[10]||(t[10]=s=>l.exportSettings.templateStyle=s)},t[49]||(t[49]=[e("option",{value:"standard"},"標準樣板",-1),e("option",{value:"professional"},"專業樣板",-1),e("option",{value:"minimal"},"簡約樣板",-1)]),512),[[F,l.exportSettings.templateStyle]])])]),e("div",ze,[t[56]||(t[56]=e("h6",{class:"mb-3"},"進階選項",-1)),e("div",Ke,[u(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[11]||(t[11]=s=>l.exportSettings.includeCharts=s),id:"includeCharts"},null,512),[[h,l.exportSettings.includeCharts]]),t[52]||(t[52]=e("label",{class:"form-check-label",for:"includeCharts"}," 包含圖表 ",-1))]),e("div",Le,[u(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[12]||(t[12]=s=>l.exportSettings.includeImages=s),id:"includeImages"},null,512),[[h,l.exportSettings.includeImages]]),t[53]||(t[53]=e("label",{class:"form-check-label",for:"includeImages"}," 包含圖片 ",-1))]),e("div",We,[u(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[13]||(t[13]=s=>l.exportSettings.includeComments=s),id:"includeComments"},null,512),[[h,l.exportSettings.includeComments]]),t[54]||(t[54]=e("label",{class:"form-check-label",for:"includeComments"}," 包含註解 ",-1))]),e("div",Ge,[u(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[14]||(t[14]=s=>l.exportSettings.compress=s),id:"compress"},null,512),[[h,l.exportSettings.compress]]),t[55]||(t[55]=e("label",{class:"form-check-label",for:"compress"}," 檔案壓縮 ",-1))])]),e("div",Je,[t[59]||(t[59]=e("h6",{class:"mb-3"},"安全設定",-1)),e("div",Oe,[u(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[15]||(t[15]=s=>l.exportSettings.passwordProtect=s),id:"passwordProtect"},null,512),[[h,l.exportSettings.passwordProtect]]),t[57]||(t[57]=e("label",{class:"form-check-label",for:"passwordProtect"}," 密碼保護 ",-1))]),l.exportSettings.passwordProtect?(i(),r("div",Qe,[t[58]||(t[58]=e("label",{class:"form-label"},"設定密碼",-1)),u(e("input",{type:"password",class:"form-control","onUpdate:modelValue":t[16]||(t[16]=s=>l.exportSettings.password=s),placeholder:"請輸入檔案密碼"},null,512),[[C,l.exportSettings.password]])])):c("",!0)])]),e("div",Re,[e("div",Xe,[l.activeTab==="scenario"&&l.selectedScenario?(i(),r("span",Ye," 已選擇："+a(l.selectedScenario.name),1)):l.activeTab==="custom"&&n.selectedFormsCount>0?(i(),r("span",Ze," 已選擇 "+a(n.selectedFormsCount)+" 個表單 ",1)):(i(),r("span",$e," 請先選擇要匯出的內容 "))]),e("div",et,[e("button",{type:"button",class:"btn btn-outline-theme",onClick:t[17]||(t[17]=(...s)=>n.previewExport&&n.previewExport(...s)),disabled:!n.canExport||l.isExporting},t[60]||(t[60]=[e("i",{class:"fa fa-eye me-1"},null,-1),d(" 預覽 ")]),8,tt),e("button",{type:"button",class:"btn btn-theme",onClick:t[18]||(t[18]=(...s)=>n.startExport&&n.startExport(...s)),disabled:!n.canExport||l.isExporting},[e("i",{class:b(["fa me-1",{"fa-spin fa-spinner":l.isExporting,"fa-download":!l.isExporting}])},null,2),d(" "+a(l.isExporting?"匯出中...":"開始匯出"),1)],8,st)])]),l.isExporting?(i(),r("div",lt,[e("div",ot,[t[61]||(t[61]=e("span",null,"匯出進度",-1)),e("span",null,a(Math.round(l.exportProgress))+"%",1)]),e("div",it,[e("div",{class:"progress-bar progress-bar-striped progress-bar-animated",style:P({width:l.exportProgress+"%"})},null,4)])])):c("",!0)]),_:1})]),_:1})):c("",!0)])]),e("div",{class:b(["modal fade",{show:l.showPreview}]),style:P({display:l.showPreview?"block":"none"}),tabindex:"-1"},[e("div",rt,[e("div",nt,[e("div",at,[t[62]||(t[62]=e("h5",{class:"modal-title"},[e("i",{class:"fa fa-eye me-2"}),d(" 匯出預覽 ")],-1)),e("button",{type:"button",class:"btn-close",onClick:t[19]||(t[19]=s=>l.showPreview=!1)})]),l.previewData?(i(),r("div",dt,[t[68]||(t[68]=e("div",{class:"alert alert-info",role:"alert"},[e("i",{class:"fa fa-info-circle me-2"}),d(" 預覽僅顯示匯出內容概要，實際檔案將包含完整資料 ")],-1)),e("div",ct,[e("div",mt,[t[63]||(t[63]=e("strong",null,"匯出標題：",-1)),d(a(l.previewData.title),1)]),e("div",ut,[t[64]||(t[64]=e("strong",null,"預估頁數：",-1)),d(a(l.previewData.totalPages)+" 頁 ",1)])]),e("div",pt,[t[65]||(t[65]=e("strong",null,"包含表單：",-1)),e("div",ft,[(i(!0),r(g,null,v(l.previewData.forms,(s,p)=>(i(),r("span",{key:p,class:"badge border border-secondary text-secondary px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center me-1 mb-1"},a(s),1))),128))])]),e("div",bt,[t[67]||(t[67]=e("h6",null,"檔案結構預覽",-1)),e("ul",xt,[(i(!0),r(g,null,v(l.previewData.forms,(s,p)=>(i(),r("li",{key:p,class:"mb-1"},[t[66]||(t[66]=e("i",{class:"fa fa-file-alt me-2 text-muted"},null,-1)),d(" "+a(s),1)]))),128))])])])):c("",!0),e("div",gt,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[20]||(t[20]=s=>l.showPreview=!1)}," 關閉 "),e("button",{type:"button",class:"btn btn-theme",onClick:t[21]||(t[21]=s=>{l.showPreview=!1,n.startExport()})},t[69]||(t[69]=[e("i",{class:"fa fa-download me-1"},null,-1),d(" 確認匯出 ")]))])])])],6),l.showPreview?(i(),r("div",{key:0,class:"modal-backdrop fade show",onClick:t[22]||(t[22]=s=>l.showPreview=!1)})):c("",!0)],64)}const wt=I(U,[["render",vt],["__scopeId","data-v-ef08b7d1"]]);export{wt as default};
