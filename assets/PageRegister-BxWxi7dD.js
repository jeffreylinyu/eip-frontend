import{d as L,E as k,G as q,r as c,a as E,b as H,e as f,f as v,l as t,A as _,m as w,s as l,v as V,I as g,J as b,i as N,p as R,L as T,R as U,M as A}from"./index-CB9Z8Gmd.js";const B={class:"login"},F={class:"login-content"},O={key:0,class:"alert alert-success mb-3",role:"alert"},D={key:1,class:"alert alert-danger mb-3",role:"alert"},I={class:"mb-3"},$={class:"mb-3"},G={class:"mb-3"},J={class:"mb-4"},W=["disabled"],j={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},z={class:"text-center text-inverse text-opacity-50"},X=L({__name:"PageRegister",setup(K){const x=k(),i=q(),r=c({username:"",email:"",password:"",confirmPassword:"",role:"OWNER"}),u=c(""),m=c(""),n=c(!1),M=()=>{u.value="",m.value=""},C={setupCustomMessages(a){a.querySelectorAll("input, select").forEach(s=>{const d=s;d.addEventListener("invalid",S=>{const o=S.target,p=o.validity;if(!(o.name==="confirmPassword"&&o.validationMessage&&o.validationMessage!==""))if(p.valueMissing)o.setCustomValidity("請填寫這個欄位");else if(p.typeMismatch)o.type==="email"?o.setCustomValidity("請輸入正確的電子郵件格式"):o.setCustomValidity("請輸入正確的格式");else if(p.tooShort){const y=o.minLength;o.setCustomValidity(`至少需要輸入 ${y} 個字元`)}else if(p.tooLong){const y=o.maxLength;o.setCustomValidity(`最多只能輸入 ${y} 個字元`)}else o.setCustomValidity("請檢查輸入內容")}),d.addEventListener("input",()=>{d.setCustomValidity("")})})},validatePasswordConfirmation(a){const e=a.querySelector('input[name="confirmPassword"]');if(!e)return!0;const s=r.value.password,d=e.value;return s!==d?(e.setCustomValidity("密碼確認不一致"),e.reportValidity(),!1):(e.setCustomValidity(""),!0)},validate(){M();const a=document.querySelector('form[name="register_form"]');return a?a.checkValidity()?!!this.validatePasswordConfirmation(a):(a.reportValidity(),!1):!1},init(){const a=document.querySelector('form[name="register_form"]');a&&this.setupCustomMessages(a)}},h=()=>C.validate(),P=async()=>{var a,e;if(h()){n.value=!0;try{const s={username:r.value.username,email:r.value.email,password:r.value.password};await A.registerIndividual(s),m.value="註冊成功！請前往登入頁面。",setTimeout(()=>{x.push("/page/login")},3e3)}catch(s){u.value=((e=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:e.message)||"註冊失敗，請稍後再試"}finally{n.value=!1}}};return E(()=>{i.appSidebarHide=!0,i.appHeaderHide=!0,i.appContentClass="p-0",setTimeout(()=>{C.init()},100)}),H(()=>{i.appSidebarHide=!1,i.appHeaderHide=!1,i.appContentClass=""}),(a,e)=>(v(),f("div",B,[t("div",F,[t("form",{onSubmit:_(P,["prevent"]),method:"POST",name:"register_form"},[e[13]||(e[13]=t("h1",{class:"text-center"},"註冊",-1)),e[14]||(e[14]=t("div",{class:"text-inverse text-opacity-50 text-center mb-4"}," 填寫您的基本資訊以建立帳戶。 ",-1)),m.value?(v(),f("div",O,[e[4]||(e[4]=t("i",{class:"fa fa-check-circle me-2"},null,-1)),l(" "+V(m.value),1)])):w("",!0),u.value?(v(),f("div",D,[e[5]||(e[5]=t("i",{class:"fa fa-exclamation-triangle me-2"},null,-1)),l(" "+V(u.value),1)])):w("",!0),t("div",I,[e[6]||(e[6]=t("label",{class:"form-label"},[l("姓名 "),t("span",{class:"text-danger"},"*")],-1)),g(t("input",{type:"text",class:"form-control form-control-lg bg-white bg-opacity-5","onUpdate:modelValue":e[0]||(e[0]=s=>r.value.username=s),placeholder:"請輸入姓名",name:"username",required:""},null,512),[[b,r.value.username]])]),t("div",$,[e[7]||(e[7]=t("label",{class:"form-label"},[l("電子郵件 "),t("span",{class:"text-danger"},"*")],-1)),g(t("input",{type:"email",class:"form-control form-control-lg bg-white bg-opacity-5","onUpdate:modelValue":e[1]||(e[1]=s=>r.value.email=s),placeholder:"請輸入電子郵件",name:"email",required:""},null,512),[[b,r.value.email]])]),t("div",G,[e[8]||(e[8]=t("label",{class:"form-label"},[l("密碼 "),t("span",{class:"text-danger"},"*")],-1)),g(t("input",{type:"password",class:"form-control form-control-lg bg-white bg-opacity-5","onUpdate:modelValue":e[2]||(e[2]=s=>r.value.password=s),placeholder:"請輸入密碼（至少6個字元）",name:"password",minlength:"6",required:""},null,512),[[b,r.value.password]])]),t("div",J,[e[9]||(e[9]=t("label",{class:"form-label"},[l("確認密碼 "),t("span",{class:"text-danger"},"*")],-1)),g(t("input",{type:"password",class:"form-control form-control-lg bg-white bg-opacity-5","onUpdate:modelValue":e[3]||(e[3]=s=>r.value.confirmPassword=s),placeholder:"請再次輸入密碼",name:"confirmPassword",required:""},null,512),[[b,r.value.confirmPassword]])]),t("button",{type:"submit",class:"btn btn-outline-theme btn-lg d-block w-100 fw-500 mb-3",disabled:n.value},[n.value?(v(),f("span",j)):w("",!0),l(" "+V(n.value?"註冊中...":"註冊"),1)],8,W),t("div",z,[e[11]||(e[11]=l(" 已經有帳戶了嗎？ ")),N(T(U),{to:"/page/login"},{default:R(()=>e[10]||(e[10]=[l("登入")])),_:1,__:[10]}),e[12]||(e[12]=l(". "))])],32)])]))}});export{X as default};
