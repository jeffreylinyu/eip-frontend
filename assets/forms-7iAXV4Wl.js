const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-0fEq5Ai7.js","assets/index-CDKlQvAB.css"])))=>i.map(i=>d[i]);
import{N as c,O as a}from"./index-0fEq5Ai7.js";const d={downloadReport:async t=>{var s;const o=Date.now()+Math.random().toString(36).substr(2,9);console.log(`[A-5 API] 開始請求 ${o}:`,t);try{let e;if(t&&Object.keys(t).length>0){let r=t;if("constructionId"in t&&"title"in t){const n=t;r={constructionId:n.constructionId,title:n.title,supervisoryName:n.supervisoryName||"",supervisoryFactory:n.supervisoryFactory||"",contractDate:n.contractDate||"",startDate:n.startDate||"",finishDate:n.finishDate||"",workedDay:n.workedDay||"",disbursementAdvancePayment:n.disbursementAdvancePayment||"",estimateAmount:n.estimateAmount||"",adjustPriceIndex:n.adjustPriceIndex||"",deductAmount:n.deductAmount||"",retention:n.retention||"",deductionAdvancePayment:n.deductionAdvancePayment||"",comment:n.comment||"",deductedColumnReason:n.deductedColumnReason||"",explainActualAmount:n.explainActualAmount||""}}e=await a(()=>import("./index-0fEq5Ai7.js").then(n=>n.Y),__vite__mapDeps([0,1])).then(n=>n.default.post("https://construction-manager-backend.onrender.com/management/construction/export/report/AFive",r,{responseType:"blob",headers:{Accept:"application/octet-stream, application/vnd.openxmlformats-officedocument.wordprocessingml.document, */*","Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`,userId:JSON.parse(localStorage.getItem("auth_user")||"{}").userId||""},timeout:3e4}))}else e=await a(()=>import("./index-0fEq5Ai7.js").then(r=>r.Y),__vite__mapDeps([0,1])).then(r=>r.default.get("https://construction-manager-backend.onrender.com/management/construction/export/report/AFive",{responseType:"blob",headers:{Accept:"application/octet-stream, application/vnd.openxmlformats-officedocument.wordprocessingml.document, */*",Authorization:`Bearer ${localStorage.getItem("auth_token")}`,userId:JSON.parse(localStorage.getItem("auth_user")||"{}").userId||""},timeout:3e4}));if(console.log(`[A-5 API] 回應詳情 ${o}:`,{status:e.status,statusText:e.statusText,headers:e.headers,dataType:typeof e.data,dataSize:((s=e.data)==null?void 0:s.size)||0,contentType:e.headers["content-type"]}),!(e.data instanceof Blob))throw console.error("回應不是 Blob 類型:",e.data),new Error("API 回應格式錯誤");return console.log(`[A-5 API] 請求完成 ${o}`),e.data}catch(e){throw console.error(`[A-5 API] 請求失敗 ${o}:`,e),e.response&&console.error("API 錯誤回應:",{status:e.response.status,statusText:e.response.statusText,data:e.response.data,headers:e.response.headers}),e}},updateForm:async t=>{try{return(await c.post("/management/construction/a5/update",t)).data}catch(o){throw console.error("A-5 表單更新失敗:",o),o}}},u={downloadReport:async t=>{var s;const o=Date.now()+Math.random().toString(36).substr(2,9);console.log(`[A-7 API] 開始請求 ${o}:`,t);try{let e;if(t&&Object.keys(t).length>0){let r=t;"constructionId"in t&&(r={constructionId:t.constructionId}),e=await a(()=>import("./index-0fEq5Ai7.js").then(n=>n.Y),__vite__mapDeps([0,1])).then(n=>n.default.post("https://construction-manager-backend.onrender.com/management/construction/export/report/ASeven",r,{responseType:"blob",headers:{Accept:"application/octet-stream, application/vnd.openxmlformats-officedocument.wordprocessingml.document, */*","Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`,userId:JSON.parse(localStorage.getItem("auth_user")||"{}").userId||""},timeout:3e4}))}else e=await a(()=>import("./index-0fEq5Ai7.js").then(r=>r.Y),__vite__mapDeps([0,1])).then(r=>r.default.get("https://construction-manager-backend.onrender.com/management/construction/export/report/ASeven",{responseType:"blob",headers:{Accept:"application/octet-stream, application/vnd.openxmlformats-officedocument.wordprocessingml.document, */*",Authorization:`Bearer ${localStorage.getItem("auth_token")}`,userId:JSON.parse(localStorage.getItem("auth_user")||"{}").userId||""},timeout:3e4}));if(console.log(`[A-7 API] 回應詳情 ${o}:`,{status:e.status,statusText:e.statusText,headers:e.headers,dataType:typeof e.data,dataSize:((s=e.data)==null?void 0:s.size)||0,contentType:e.headers["content-type"]}),!(e.data instanceof Blob))throw console.error("A-7 回應不是 Blob 類型:",e.data),new Error("A-7 API 回應格式錯誤");return console.log(`[A-7 API] 請求完成 ${o}`),e.data}catch(e){throw console.error(`[A-7 API] 請求失敗 ${o}:`,e),e.response&&console.error("A-7 API 錯誤回應:",{status:e.response.status,statusText:e.response.statusText,data:e.response.data,headers:e.response.headers}),e}},updateForm:async t=>{try{return(await c.post("/management/construction/a7/update",t)).data}catch(o){throw console.error("A-7 表單更新失敗:",o),o}}},p=(t,o)=>{try{if(console.log("開始下載檔案:",{fileName:o,blobSize:t.size,blobType:t.type,timestamp:new Date().toISOString()}),!t||t.size===0)throw console.error("Blob 無效或為空:",t),new Error("檔案資料無效");if(o.includes(".")||(o=o+".docx"),window.navigator&&window.navigator.msSaveOrOpenBlob){window.navigator.msSaveOrOpenBlob(t,o),console.log("使用 IE/Edge 下載方法");return}const s=window.URL.createObjectURL(t);console.log("創建 blob URL:",s);const e=document.createElement("a");if(e.href=s,e.download=o,e.style.display="none",typeof e.download>"u"){window.open(s,"_blank"),console.log("使用新視窗開啟檔案"),setTimeout(()=>window.URL.revokeObjectURL(s),100);return}document.body.appendChild(e),console.log("觸發下載..."),e.click(),setTimeout(()=>{document.body.contains(e)&&document.body.removeChild(e),window.URL.revokeObjectURL(s),console.log("下載連結已清理")},100)}catch(s){throw console.error("檔案下載失敗:",s),new Error("檔案下載失敗: "+s.message)}},l=t=>{if(t===0)return"0 Bytes";const o=1024,s=["Bytes","KB","MB","GB"],e=Math.floor(Math.log(t)/Math.log(o));return parseFloat((t/Math.pow(o,e)).toFixed(2))+" "+s[e]},m=t=>{var o;if(t.response){const s=t.response.status,e=((o=t.response.data)==null?void 0:o.message)||t.message;switch(s){case 400:return"請求參數錯誤，請檢查輸入資料";case 401:return"未授權，請重新登入";case 403:return"權限不足，無法執行此操作";case 404:return"找不到指定的資源";case 500:return"伺服器內部錯誤，請稍後重試";default:return e||"未知錯誤"}}else return t.request?"網路連線失敗，請檢查網路狀態":t.message||"操作失敗"};export{l as a,u as b,p as d,d as f,m as h};
