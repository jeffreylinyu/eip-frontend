const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CB9Z8Gmd.js","assets/index-CpGi58yR.css"])))=>i.map(i=>d[i]);
import{U as s,Z as r}from"./index-CB9Z8Gmd.js";const i={downloadReport:async o=>{const n=Date.now()+Math.random().toString(36).substr(2,9);try{let e;if(o&&Object.keys(o).length>0){let a=o;if("constructionId"in o&&"title"in o){const t=o;a={constructionId:t.constructionId,title:t.title,supervisoryName:t.supervisoryName||"",supervisoryFactory:t.supervisoryFactory||"",contractDate:t.contractDate||"",startDate:t.startDate||"",finishDate:t.finishDate||"",workedDay:t.workedDay||"",disbursementAdvancePayment:t.disbursementAdvancePayment||"",estimateAmount:t.estimateAmount||"",adjustPriceIndex:t.adjustPriceIndex||"",deductAmount:t.deductAmount||"",retention:t.retention||"",deductionAdvancePayment:t.deductionAdvancePayment||"",comment:t.comment||"",deductedColumnReason:t.deductedColumnReason||"",explainActualAmount:t.explainActualAmount||""}}e=await r(()=>import("./index-CB9Z8Gmd.js").then(t=>t.ao),__vite__mapDeps([0,1])).then(t=>t.default.post("https://construction-manager-backend-200440251043.asia-east1.run.app/management/construction/export/report/AFive",a,{responseType:"blob",headers:{Accept:"application/octet-stream, application/vnd.openxmlformats-officedocument.wordprocessingml.document, */*","Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`,userId:JSON.parse(localStorage.getItem("auth_user")||"{}").userId||""},timeout:3e4}))}else e=await r(()=>import("./index-CB9Z8Gmd.js").then(a=>a.ao),__vite__mapDeps([0,1])).then(a=>a.default.get("https://construction-manager-backend-200440251043.asia-east1.run.app/management/construction/export/report/AFive",{responseType:"blob",headers:{Accept:"application/octet-stream, application/vnd.openxmlformats-officedocument.wordprocessingml.document, */*",Authorization:`Bearer ${localStorage.getItem("auth_token")}`,userId:JSON.parse(localStorage.getItem("auth_user")||"{}").userId||""},timeout:3e4}));if(!(e.data instanceof Blob))throw console.error("回應不是 Blob 類型:",e.data),new Error("API 回應格式錯誤");return e.data}catch(e){throw console.error(`[A-5 API] 請求失敗 ${n}:`,e),e.response&&console.error("API 錯誤回應:",{status:e.response.status,statusText:e.response.statusText,data:e.response.data,headers:e.response.headers}),e}},updateForm:async o=>{try{return(await s.post("/management/construction/a5/update",o)).data}catch(n){throw console.error("A-5 表單更新失敗:",n),n}}},u={downloadReport:async o=>{const n=Date.now()+Math.random().toString(36).substr(2,9);try{let e;if(o&&Object.keys(o).length>0){let a=o;if("constructionId"in o&&"title"in o){const t=o;a={constructionId:t.constructionId,title:t.title,sequenceNumber:t.sequenceNumber||"",extensionFactor:t.extensionFactor||"",approvalDocumentNumber:t.approvalDocumentNumber||"",extensionDays:t.extensionDays||"",completionDateAfterExtension:t.completionDateAfterExtension||"",originalSchedule:t.originalSchedule||"",revisedSchedule:t.revisedSchedule||"",impactAnalysis:t.impactAnalysis||"",mitigationMeasures:t.mitigationMeasures||"",additionalCost:t.additionalCost||"",approvalStatus:t.approvalStatus||"",comment:t.comment||"",supportingDocuments:t.supportingDocuments||"",approvalDate:t.approvalDate||""}}e=await r(()=>import("./index-CB9Z8Gmd.js").then(t=>t.ao),__vite__mapDeps([0,1])).then(t=>t.default.post("https://construction-manager-backend-200440251043.asia-east1.run.app/management/construction/export/report/AFour",a,{responseType:"blob",headers:{Accept:"application/octet-stream, application/vnd.openxmlformats-officedocument.wordprocessingml.document, */*","Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`,userId:JSON.parse(localStorage.getItem("auth_user")||"{}").userId||""},timeout:3e4}))}else e=await r(()=>import("./index-CB9Z8Gmd.js").then(a=>a.ao),__vite__mapDeps([0,1])).then(a=>a.default.get("https://construction-manager-backend-200440251043.asia-east1.run.app/management/construction/export/report/AFour",{responseType:"blob",headers:{Accept:"application/octet-stream, application/vnd.openxmlformats-officedocument.wordprocessingml.document, */*",Authorization:`Bearer ${localStorage.getItem("auth_token")}`,userId:JSON.parse(localStorage.getItem("auth_user")||"{}").userId||""},timeout:3e4}));if(!(e.data instanceof Blob))throw console.error("A-4 回應不是 Blob 類型:",e.data),new Error("A-4 API 回應格式錯誤");return e.data}catch(e){throw console.error(`[A-4 API] 請求失敗 ${n}:`,e),e.response&&console.error("A-4 API 錯誤回應:",{status:e.response.status,statusText:e.response.statusText,data:e.response.data,headers:e.response.headers}),e}},updateForm:async o=>{try{return(await s.post("/management/construction/a4/update",o)).data}catch(n){throw console.error("A-4 表單更新失敗:",n),n}}},p={downloadReport:async o=>{const n=Date.now()+Math.random().toString(36).substr(2,9);try{let e;if(o&&Object.keys(o).length>0){let a=o;if("constructionId"in o){const t=o;a={title:t.title,constructionId:t.constructionId,companyId:t.companyId}}e=await r(()=>import("./index-CB9Z8Gmd.js").then(t=>t.ao),__vite__mapDeps([0,1])).then(t=>t.default.post("https://construction-manager-backend-200440251043.asia-east1.run.app/management/construction/export/report/ASeven",a,{responseType:"blob",headers:{Accept:"application/octet-stream, application/vnd.openxmlformats-officedocument.wordprocessingml.document, */*","Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`,userId:JSON.parse(localStorage.getItem("auth_user")||"{}").userId||""},timeout:3e4}))}else e=await r(()=>import("./index-CB9Z8Gmd.js").then(a=>a.ao),__vite__mapDeps([0,1])).then(a=>a.default.get("https://construction-manager-backend-200440251043.asia-east1.run.app/management/construction/export/report/ASeven",{responseType:"blob",headers:{Accept:"application/octet-stream, application/vnd.openxmlformats-officedocument.wordprocessingml.document, */*",Authorization:`Bearer ${localStorage.getItem("auth_token")}`,userId:JSON.parse(localStorage.getItem("auth_user")||"{}").userId||""},timeout:3e4}));if(!(e.data instanceof Blob))throw console.error("A-7 回應不是 Blob 類型:",e.data),new Error("A-7 API 回應格式錯誤");return e.data}catch(e){throw console.error(`[A-7 API] 請求失敗 ${n}:`,e),e.response&&console.error("A-7 API 錯誤回應:",{status:e.response.status,statusText:e.response.statusText,data:e.response.data,headers:e.response.headers}),e}},updateForm:async o=>{try{return(await s.post("/management/construction/a7/update",o)).data}catch(n){throw console.error("A-7 表單更新失敗:",n),n}}},d=(o,n)=>{try{if(!o||o.size===0)throw console.error("Blob 無效或為空:",o),new Error("檔案資料無效");if(n.includes(".")||(n=n+".docx"),window.navigator&&window.navigator.msSaveOrOpenBlob){window.navigator.msSaveOrOpenBlob(o,n);return}const e=window.URL.createObjectURL(o),a=document.createElement("a");if(a.href=e,a.download=n,a.style.display="none",typeof a.download>"u"){window.open(e,"_blank"),setTimeout(()=>window.URL.revokeObjectURL(e),100);return}document.body.appendChild(a),a.click(),setTimeout(()=>{document.body.contains(a)&&document.body.removeChild(a),window.URL.revokeObjectURL(e)},100)}catch(e){throw console.error("檔案下載失敗:",e),new Error("檔案下載失敗: "+e.message)}},l=o=>{if(o===0)return"0 Bytes";const n=1024,e=["Bytes","KB","MB","GB"],a=Math.floor(Math.log(o)/Math.log(n));return parseFloat((o/Math.pow(n,a)).toFixed(2))+" "+e[a]},m=o=>{var n;if(o.response){const e=o.response.status,a=((n=o.response.data)==null?void 0:n.message)||o.message;switch(e){case 400:return"請求參數錯誤，請檢查輸入資料";case 401:return"未授權，請重新登入";case 403:return"權限不足，無法執行此操作";case 404:return"找不到指定的資源";case 500:return"伺服器內部錯誤，請稍後重試";default:return a||"未知錯誤"}}else return o.request?"網路連線失敗，請檢查網路狀態":o.message||"操作失敗"};export{l as a,i as b,p as c,d,u as f,m as h};
