import{U as T,d as fe,j as _e,r as h,k as ae,a as he,c as ye,e as r,f as u,l as e,i as m,p,q as B,x as U,v as c,C as S,F as V,y as $,z as N,S as se,m as I,s as O,I as y,J as g,K as ne,V as be,_ as ge}from"./index-CB9Z8Gmd.js";import{b as le,d as oe,a as xe,h as H}from"./forms-OBaJqV0P.js";const J={async getEstimateList(x){try{const d=await T.get("/management/estimate/list",{params:x});return Array.isArray(d.data)?{data:d.data,total:d.data.length,page:1,limit:d.data.length}:d.data&&Array.isArray(d.data.data)?{data:d.data.data,total:d.data.total||d.data.data.length,page:d.data.page||1,limit:d.data.limit||d.data.data.length}:{data:d.data||[],total:0,page:1,limit:0}}catch(d){throw console.error("取得估驗記錄列表失敗:",d),d}},async createEstimate(x){try{return(await T.post("/management/estimate/create",x)).data}catch(d){throw console.error("新增估驗記錄失敗:",d),d}},async updateEstimate(x){try{return(await T.patch("/management/estimate/update",x)).data}catch(d){throw console.error("更新估驗記錄失敗:",d),d}},async deleteEstimate(x){try{return(await T.delete(`/management/estimate/delete/${x}`)).data}catch(d){throw console.error("刪除估驗記錄失敗:",d),d}},async batchUpdateEstimates(x){try{return(await T.patch("/management/estimate/batch-update",{records:x})).data}catch(d){throw console.error("批量更新估驗記錄失敗:",d),d}}},we={class:"container-fluid"},Ae={class:"row"},Pe={class:"col-12"},ke={class:"row"},Ie={class:"col-lg-4 mb-4"},je={class:"flex-grow-1 d-flex flex-column justify-content-around"},De={class:"d-flex align-items-center"},Ce={class:"badge border border-primary text-primary px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center me-2"},Ue={class:"badge border border-secondary text-secondary px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center"},Se={class:"mb-2"},Ve={class:"text-muted small"},Fe={class:"row"},Ee={class:"col-6"},Te={class:"border rounded p-2"},$e={class:"fw-bold"},Ne={class:"col-6"},Me={class:"border rounded p-2"},Re={class:"fw-bold small"},ze={class:"col-lg-8 mb-4"},qe={class:"row"},Be={class:"d-flex align-items-center mb-3"},Oe={class:"param-icon me-3"},We={class:"flex-grow-1"},Le={class:"mb-1"},He={class:"text-muted small mb-0"},Je={class:"mb-3"},Ke={class:"d-flex justify-content-between align-items-center mb-2"},Ge={class:"small fw-bold"},Qe={class:"progress",style:{height:"6px"}},Xe={class:"small text-muted mt-1"},Ye={class:"filled-fields-preview"},Ze={key:0,class:"text-center"},et={class:"text-white mb-2"},tt={class:"fw-bold"},at={class:"text-white mb-2"},st={class:"fw-bold"},nt={class:"text-white"},lt={class:"fw-bold"},ot={key:1},dt={key:0,class:"small text-muted"},it={class:"row"},ct={class:"col-lg-8 mb-4"},rt={class:"row"},ut={class:"col-lg-6"},mt={class:"mb-3"},pt={class:"form-text small"},vt={class:"col-lg-6"},ft={class:"mb-3"},_t={class:"form-check mb-2"},ht={class:"form-check"},yt={class:"d-flex justify-content-between align-items-center mt-3 pt-3 border-top"},bt=["disabled"],gt={key:0,class:"mt-3"},xt={class:"d-flex justify-content-between align-items-center mb-2"},wt={class:"small"},At={class:"progress"},Pt={class:"col-lg-4 mb-4"},kt={key:0,class:"text-center py-3"},It={key:1},jt={class:"d-flex justify-content-between align-items-start mb-2"},Dt={class:"mb-1 small"},Ct=["onClick"],Ut={class:"text-muted small mb-1"},St={class:"d-flex justify-content-between"},Vt={class:"text-muted"},Ft={class:"text-muted"},Et={key:0,class:"params-form"},Tt={class:"text-muted mb-4"},$t={key:0,class:"table-responsive"},Nt={class:"d-flex justify-content-between align-items-center mb-3"},Mt=["disabled"],Rt={class:"table table-bordered"},zt={class:"fw-bold"},qt=["onUpdate:modelValue","onInput"],Bt=["onUpdate:modelValue","onInput"],Ot=["onUpdate:modelValue","onInput"],Wt=["onUpdate:modelValue","onInput"],Lt=["onUpdate:modelValue","onInput"],Ht=["onUpdate:modelValue"],Jt=["onClick","disabled"],Kt={key:0,class:"text-center py-4"},Gt={key:1,class:"row"},Qt={class:"form-label"},Xt={key:0,class:"text-danger"},Yt=["onUpdate:modelValue","placeholder"],Zt=["onUpdate:modelValue"],ea=["onUpdate:modelValue","placeholder"],ta=["onUpdate:modelValue","placeholder"],aa=fe({__name:"FormA5Download",setup(x){const d=_e();h(!1);const w=h(!1),j=h(0),F=h(""),K=h(!1),G=h(!0),M=h(!1),R=h(""),W=h(!1),f=h({supervisoryName:"",supervisoryFactory:"",contractDate:"",startDate:"",finishDate:"",workedDay:"",disbursementAdvancePayment:"",estimateAmount:"",adjustPriceIndex:"",deductAmount:"",retention:"",deductionAdvancePayment:"",comment:"",deductedColumnReason:"",explainActualAmount:""}),A={code:"A-5",name:"估驗請款計價單",description:"估驗請款計價單是工程進度款項申請的重要文件，包含工程進度、計價項目、請款金額等內容。",category:"A類表單",version:"v2.1",lastUpdate:"2024-01-15",requiredFields:["工程基本資訊","計價項目明細","工程進度說明","請款金額計算","估驗資料","付款條件","附件清單"]},_=h([{id:"current",constructionId:"",period:"本次",estimateAmount:0,adjustPriceIndex:0,deductAmount:0,retention:0,deductionAdvancePayment:0,deductedReason:"",amountPayable:0,accumulatedAdvancePayment:0,cumulativeDisbursementAdvancePayment:0,lastUpdateAmountContract:0,notDeductedAdvancePayment:0,originContractPayment:0,payment:0,percentageOfFinish:0,percentageOfTotalFinish:0,previewsAdjustPriceIndex:0,previewsDeductAmount:0,previewsDeductionAdvancePayment:0,previewsEstimateAmount:0,previewsRetention:0,previewsTotalPayment:0,totalAdjustPriceIndex:0,totalDeductAmount:0,totalDeductionAdvancePayment:0,totalEstimateAmount:0,totalPayment:0,totalRetention:0,workedDay:0}]),Q=h([]),z=h(!1),q=[{id:"estimate-detail",title:"估驗詳細表",icon:"fa fa-table",description:"維護估驗請款計價單的詳細資料",isTable:!0,fields:void 0}],D=h([{id:1,fileName:"A-5_估驗請款計價單_台北市政府建管處版本_2024-01-15.docx",template:"台北市政府建管處版本",downloadTime:"2024-01-15 14:30:25",fileSize:"1.2 MB"},{id:2,fileName:"A-5_估驗請款計價單_新北市政府工務局版本_2024-01-10.docx",template:"新北市政府工務局版本",downloadTime:"2024-01-10 09:15:42",fileSize:"1.1 MB"}]),X=ae(()=>!w.value),L=ae(()=>F.value.trim()?F.value.trim():`A-5_估驗請款計價單_${new Date().toISOString().split("T")[0]}`),de=async()=>{var t;if(!X.value||w.value)return;w.value=!0,j.value=0;let a=null;try{const n={constructionId:((t=d.currentProject)==null?void 0:t.id)||"",title:F.value.trim()||L.value,...f.value};a=setInterval(()=>{j.value<90&&(j.value+=Math.random()*10)},200);const s=await le.downloadReport(n);j.value=100,a&&(clearInterval(a),a=null);const v=`${L.value}.docx`;oe(s,v);const l={id:D.value.length+1,fileName:v,template:"A-5 估驗請款計價單",downloadTime:new Date().toLocaleString("zh-TW"),fileSize:xe(s.size)};D.value.unshift(l),D.value.length>10&&(D.value=D.value.slice(0,10)),C("下載成功！",`${v} 已開始下載`,"success")}catch(n){console.error("下載失敗:",n),H(n)}finally{a&&clearInterval(a),w.value=!1,j.value=0}},C=(a,t,n="success")=>{},ie=async a=>{var t;try{w.value=!0;const n={constructionId:((t=d.currentProject)==null?void 0:t.id)||"",title:a.fileName.replace(".docx","").replace(".pdf",""),...f.value},s=await le.downloadReport(n);oe(s,a.fileName),C("重新下載成功",`${a.fileName} 已開始下載`,"success")}catch(n){H(n)}finally{w.value=!1}},ce=a=>{R.value=a,M.value=!0},Y=()=>{M.value=!1,R.value=""},re=async()=>{try{W.value=!0;const a=q.find(t=>t.id===R.value);if(a&&!a.isTable){if(a.fields&&a.fields.length>0){const n=a.fields.filter(s=>s.required).filter(s=>!f.value[s.key]);if(n.length>0){C("驗證失敗",`請填寫必填欄位：${n.map(s=>s.label).join("、")}`,"error");return}}}C("保存成功","參數已成功保存","success"),Y()}catch(a){H(a)}finally{W.value=!1}},P=()=>q.find(a=>a.id===R.value),ue=(a,t)=>t?a.estimateAmount!==t.estimateAmount||a.adjustPriceIndex!==t.adjustPriceIndex||a.deductAmount!==t.deductAmount||a.retention!==t.retention||a.deductionAdvancePayment!==t.deductionAdvancePayment||a.deductedReason!==t.deductedReason:!0,E=(a,t,n)=>{const s=_.value.find(v=>v.id===a);s&&(s[t]=n,t!=="amountPayable"&&(s.amountPayable=s.estimateAmount+s.adjustPriceIndex-s.deductAmount-s.retention-s.deductionAdvancePayment))},me=async()=>{var t;const a=((t=d.currentProject)==null?void 0:t.id)||"";if(a)try{z.value=!0;const n=await J.getEstimateList({constructionId:a});if(n.data)if(Array.isArray(n.data))n.data.length>0?_.value=n.data.map(s=>({...s,period:s.period||"本次",amountPayable:s.estimateAmount+s.adjustPriceIndex-s.deductAmount-s.retention-s.deductionAdvancePayment})):_.value[0].constructionId=a;else{const s=n.data;_.value=[{...s,id:s.id||"current",constructionId:a,period:"本次",amountPayable:(s.estimateAmount||0)+(s.adjustPriceIndex||0)-(s.deductAmount||0)-(s.retention||0)-(s.deductionAdvancePayment||0)}]}else _.value[0].constructionId=a;Q.value=JSON.parse(JSON.stringify(_.value))}catch(n){console.error("❌ 載入估驗記錄列表失敗:",n)}finally{z.value=!1}},pe=async()=>{var t;const a=((t=d.currentProject)==null?void 0:t.id)||"";if(a)try{const n={constructionId:a,period:"本次",estimateAmount:0,adjustPriceIndex:0,deductAmount:0,retention:0,deductionAdvancePayment:0,deductedReason:"",amountPayable:0,accumulatedAdvancePayment:0,cumulativeDisbursementAdvancePayment:0,lastUpdateAmountContract:0,notDeductedAdvancePayment:0,originContractPayment:0,payment:0,percentageOfFinish:0,percentageOfTotalFinish:0,previewsAdjustPriceIndex:0,previewsDeductAmount:0,previewsDeductionAdvancePayment:0,previewsEstimateAmount:0,previewsRetention:0,previewsTotalPayment:0,totalAdjustPriceIndex:0,totalDeductAmount:0,totalDeductionAdvancePayment:0,totalEstimateAmount:0,totalPayment:0,totalRetention:0,workedDay:0},s=`est_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;n.id=s,_.value.push(n),C("新增成功","已新增空白記錄，請填寫相關資訊","success")}catch(n){console.error("❌ 新增估驗記錄失敗:",n)}},ve=async a=>{if(!a.id||a.id.startsWith("est_"))try{const t={constructionId:a.constructionId,estimateAmount:a.estimateAmount,adjustPriceIndex:a.adjustPriceIndex,deductAmount:a.deductAmount,retention:a.retention,deductionAdvancePayment:a.deductionAdvancePayment,deductedReason:a.deductedReason||""},n=await J.createEstimate(t);n.data&&n.data.id&&(a.id=n.data.id),C("保存成功","估驗記錄已成功保存","success")}catch(t){console.error("❌ 保存估驗記錄失敗:",t)}else{const t=Q.value.find(s=>s.id===a.id);if(ue(a,t))try{const s={estimateId:a.id,estimateAmount:a.estimateAmount,originContractPayment:0,comment:"",adjustPriceIndex:a.adjustPriceIndex,disbursementAdvancePayment:a.deductionAdvancePayment,retention:a.retention,deductedReason:a.deductedReason||""};await J.updateEstimate(s),C("更新成功","估驗記錄已成功更新","success")}catch(s){console.error("❌ 更新估驗記錄失敗:",s)}}},k=a=>{const t=q.find(n=>n.id===a);if(!t)return{completed:0,total:0,percentage:0};if(t.isTable){const n=_.value.length,s=_.value.filter(v=>v.estimateAmount>0||v.amountPayable>0).length;return{completed:s,total:n,percentage:n>0?Math.round(s/n*100):0}}if(t.fields&&t.fields.length>0){const n=t.fields.filter(v=>v.required),s=n.filter(v=>f.value[v.key]);return{completed:s.length,total:n.length,percentage:Math.round(s.length/n.length*100)}}return{completed:0,total:0,percentage:0}};return he(()=>{me()}),(a,t)=>{var s,v;const n=ye("PageHeader");return u(),r(V,null,[e("div",we,[e("div",Ae,[e("div",Pe,[m(n,{title:`${A.code} - ${A.name}`,icon:"fa fa-file-alt",breadcrumbs:[{text:"表單生成與管理",href:"javascript:;"},{text:"A類表單",href:"javascript:;"},{text:`${A.code} ${A.name}`,active:!0}]},null,8,["title","breadcrumbs"]),e("div",ke,[e("div",Ie,[m(S,{class:"h-100"},{default:p(()=>[m(B,null,{default:p(()=>t[4]||(t[4]=[e("div",{class:"d-flex align-items-center"},[e("i",{class:"fa fa-info-circle me-2"}),e("h5",{class:"mb-0"},"表單資訊")],-1)])),_:1,__:[4]}),m(U,{class:"d-flex flex-column h-100"},{default:p(()=>[e("div",je,[e("div",De,[e("span",Ce,c(A.code),1),e("span",Ue,c(A.category),1)]),e("div",null,[e("h6",Se,c(A.name),1),e("p",Ve,c(A.description),1)]),e("div",null,[e("div",Fe,[e("div",Ee,[e("div",Te,[t[5]||(t[5]=e("div",{class:"text-muted small"},"版本",-1)),e("div",$e,c(A.version),1)])]),e("div",Ne,[e("div",Me,[t[6]||(t[6]=e("div",{class:"text-muted small"},"更新日期",-1)),e("div",Re,c(A.lastUpdate),1)])])])])])]),_:1})]),_:1})]),e("div",ze,[m(S,null,{default:p(()=>[m(B,null,{default:p(()=>t[7]||(t[7]=[e("div",{class:"d-flex align-items-center"},[e("i",{class:"fa fa-edit me-2"}),e("h5",{class:"mb-0"},"表單參數填寫")],-1)])),_:1,__:[7]}),m(U,null,{default:p(()=>[t[10]||(t[10]=e("p",{class:"text-muted mb-4"},"請填寫以下參數以生成完整的估驗請款計價單。點擊各區塊可進行參數設定。",-1)),e("div",qe,[(u(),r(V,null,$(q,l=>e("div",{key:l.id,class:"col-lg-6 mb-3"},[m(S,{class:"h-100 cursor-pointer param-section-card",onClick:b=>ce(l.id)},{default:p(()=>[m(U,{class:"p-4"},{default:p(()=>[e("div",Be,[e("div",Oe,[e("i",{class:N(l.icon)},null,2)]),e("div",We,[e("h6",Le,c(l.title),1),e("p",He,c(l.description),1)])]),e("div",Je,[e("div",Ke,[t[8]||(t[8]=e("span",{class:"small text-muted"},"完成度",-1)),e("span",Ge,c(k(l.id).percentage)+"%",1)]),e("div",Qe,[e("div",{class:N(["progress-bar",{"bg-success":k(l.id).percentage===100,"bg-warning":k(l.id).percentage>0&&k(l.id).percentage<100,"bg-secondary":k(l.id).percentage===0}]),style:se({width:k(l.id).percentage+"%"})},null,6)]),e("div",Xe,c(k(l.id).completed)+" / "+c(k(l.id).total)+" 必填項目 ",1)]),e("div",Ye,[l.isTable?(u(),r("div",Ze,[e("div",et,[e("span",tt,"估驗記錄："+c(_.value.length)+" 筆",1)]),e("div",at,[e("span",st,"已完成："+c(_.value.filter(b=>b.estimateAmount>0||b.amountPayable>0).length)+" 筆",1)]),e("div",nt,[e("span",lt,"記錄總數："+c(_.value.length)+" 筆",1)])])):l.fields&&l.fields.length>0?(u(),r("div",ot,[(u(!0),r(V,null,$(l.fields.slice(0,3),b=>(u(),r("div",{key:b.key,class:"d-flex align-items-center mb-1"},[e("i",{class:N(["fa me-2 small",f.value[b.key]?"fa-check-circle text-success":"fa-circle text-muted"])},null,2),e("span",{class:N(["small",f.value[b.key]?"text-dark":"text-muted"])},c(b.label),3)]))),128)),l.fields.length>3?(u(),r("div",dt," ... 還有 "+c(l.fields.length-3)+" 個欄位 ",1)):I("",!0)])):I("",!0)]),t[9]||(t[9]=e("div",{class:"text-center mt-3"},[e("button",{class:"btn btn-outline-theme btn-sm"},[e("i",{class:"fa fa-edit me-1"}),O(" 填寫參數 ")])],-1))]),_:2,__:[9]},1024)]),_:2},1032,["onClick"])])),64))])]),_:1,__:[10]})]),_:1})])]),e("div",it,[e("div",ct,[m(S,null,{default:p(()=>[m(B,null,{default:p(()=>t[11]||(t[11]=[e("div",{class:"d-flex align-items-center"},[e("i",{class:"fa fa-cog me-2"}),e("h5",{class:"mb-0"},"下載設定")],-1)])),_:1,__:[11]}),m(U,null,{default:p(()=>[e("div",rt,[e("div",ut,[e("div",mt,[t[12]||(t[12]=e("label",{class:"form-label"},"自訂檔案名稱",-1)),y(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=l=>F.value=l),placeholder:"留空則使用預設名稱"},null,512),[[g,F.value]]),e("div",pt," 預設名稱："+c(L.value),1)])]),e("div",vt,[e("div",ft,[t[15]||(t[15]=e("label",{class:"form-label"},"附加選項",-1)),e("div",_t,[y(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=l=>K.value=l),id:"includeWatermark"},null,512),[[ne,K.value]]),t[13]||(t[13]=e("label",{class:"form-check-label small",for:"includeWatermark"}," 包含浮水印 ",-1))]),e("div",ht,[y(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=l=>G.value=l),id:"includeSignature"},null,512),[[ne,G.value]]),t[14]||(t[14]=e("label",{class:"form-check-label small",for:"includeSignature"}," 包含簽名欄位 ",-1))])])])]),e("div",yt,[t[16]||(t[16]=e("div",{class:"text-muted"},[e("i",{class:"fa fa-info-circle me-1"}),e("span",null,"準備下載：A-5 估驗請款計價單")],-1)),e("button",{class:"btn btn-theme btn-lg",onClick:de,disabled:!X.value},[e("i",{class:N(["fa me-2",{"fa-spin fa-spinner":w.value,"fa-download":!w.value}])},null,2),O(" "+c(w.value?"處理中...":"下載表單"),1)],8,bt)]),w.value?(u(),r("div",gt,[e("div",xt,[t[17]||(t[17]=e("span",{class:"small"},"正在生成文件...",-1)),e("span",wt,c(Math.round(j.value))+"%",1)]),e("div",At,[e("div",{class:"progress-bar progress-bar-striped progress-bar-animated",style:se({width:j.value+"%"})},null,4)])])):I("",!0)]),_:1})]),_:1})]),e("div",Pt,[m(S,null,{default:p(()=>[m(B,null,{default:p(()=>t[18]||(t[18]=[e("div",{class:"d-flex align-items-center"},[e("i",{class:"fa fa-history me-2"}),e("h5",{class:"mb-0"},"最近下載")],-1)])),_:1,__:[18]}),m(U,null,{default:p(()=>[D.value.length===0?(u(),r("div",kt,t[19]||(t[19]=[e("i",{class:"fa fa-download fa-2x text-muted mb-2"},null,-1),e("p",{class:"text-muted small mb-0"},"尚無下載記錄",-1)]))):(u(),r("div",It,[(u(!0),r(V,null,$(D.value,l=>(u(),r("div",{key:l.id,class:"mb-3"},[m(S,{class:"download-item"},{default:p(()=>[m(U,{class:"p-3"},{default:p(()=>[e("div",jt,[e("h6",Dt,c(l.template),1),e("button",{class:"btn btn-outline-theme btn-sm",onClick:b=>ie(l)},t[20]||(t[20]=[e("i",{class:"fa fa-download"},null,-1)]),8,Ct)]),e("p",Ut,c(l.fileName),1),e("div",St,[e("small",Vt,c(l.downloadTime),1),e("small",Ft,c(l.fileSize),1)])]),_:2},1024)]),_:2},1024)]))),128))]))]),_:1})]),_:1})])])])])]),m(be,{show:M.value,title:((s=P())==null?void 0:s.title)||"參數填寫",icon:((v=P())==null?void 0:v.icon)||"fa fa-edit",size:"xl","modal-id":"params-modal","confirm-text":"保存","cancel-text":"取消","confirm-icon":"fa fa-save","is-loading":W.value,"onUpdate:show":t[3]||(t[3]=l=>M.value=l),onConfirm:re,onHide:Y},{body:p(()=>{var l,b,Z,ee,te;return[P()?(u(),r("div",Et,[e("p",Tt,c((l=P())==null?void 0:l.description),1),(b=P())!=null&&b.isTable?(u(),r("div",$t,[e("div",Nt,[t[22]||(t[22]=e("h6",{class:"mb-0"},"估驗詳細表",-1)),e("button",{class:"btn btn-outline-primary btn-sm",onClick:pe,disabled:z.value},t[21]||(t[21]=[e("i",{class:"fa fa-plus me-1"},null,-1),O(" 新增記錄 ")]),8,Mt)]),e("table",Rt,[t[24]||(t[24]=e("thead",{class:"table-light"},[e("tr",null,[e("th",{style:{width:"100px"}},"期別"),e("th",{style:{width:"150px"}},"估驗計價款"),e("th",{style:{width:"150px"}},"物價指數調整款"),e("th",{style:{width:"120px"}},"扣款"),e("th",{style:{width:"120px"}},"保留款"),e("th",{style:{width:"150px"}},"扣回預付款"),e("th",{style:{width:"150px"}},"應付金額"),e("th",{style:{width:"80px"}},"操作")])],-1)),e("tbody",null,[(u(!0),r(V,null,$(_.value,o=>(u(),r("tr",{key:o.id},[e("td",zt,c(o.period),1),e("td",null,[y(e("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":i=>o.estimateAmount=i,onInput:i=>E(o.id,"estimateAmount",parseFloat(i.target.value)||0),placeholder:"0",step:"0.01"},null,40,qt),[[g,o.estimateAmount]])]),e("td",null,[y(e("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":i=>o.adjustPriceIndex=i,onInput:i=>E(o.id,"adjustPriceIndex",parseFloat(i.target.value)||0),placeholder:"0",step:"0.01"},null,40,Bt),[[g,o.adjustPriceIndex]])]),e("td",null,[y(e("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":i=>o.deductAmount=i,onInput:i=>E(o.id,"deductAmount",parseFloat(i.target.value)||0),placeholder:"0",step:"0.01"},null,40,Ot),[[g,o.deductAmount]])]),e("td",null,[y(e("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":i=>o.retention=i,onInput:i=>E(o.id,"retention",parseFloat(i.target.value)||0),placeholder:"0",step:"0.01"},null,40,Wt),[[g,o.retention]])]),e("td",null,[y(e("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":i=>o.deductionAdvancePayment=i,onInput:i=>E(o.id,"deductionAdvancePayment",parseFloat(i.target.value)||0),placeholder:"0",step:"0.01"},null,40,Lt),[[g,o.deductionAdvancePayment]])]),e("td",null,[y(e("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":i=>o.amountPayable=i,placeholder:"自動計算",step:"0.01",readonly:""},null,8,Ht),[[g,o.amountPayable]])]),e("td",null,[e("button",{class:"btn btn-outline-primary btn-sm",onClick:i=>ve(o),disabled:z.value},t[23]||(t[23]=[e("i",{class:"fa fa-save"},null,-1)]),8,Jt)])]))),128))])]),_.value.length===0?(u(),r("div",Kt,t[25]||(t[25]=[e("i",{class:"fa fa-table fa-2x text-muted mb-2"},null,-1),e("p",{class:"text-muted"},"尚無估驗記錄",-1)]))):I("",!0)])):(Z=P())!=null&&Z.fields&&((ee=P())==null?void 0:ee.fields.length)>0?(u(),r("div",Gt,[(u(!0),r(V,null,$((te=P())==null?void 0:te.fields,o=>(u(),r("div",{key:o.key,class:"col-12 mb-3"},[e("label",Qt,[O(c(o.label)+" ",1),o.required?(u(),r("span",Xt,"*")):I("",!0)]),o.type==="text"?y((u(),r("input",{key:0,type:"text",class:"form-control","onUpdate:modelValue":i=>f.value[o.key]=i,placeholder:`請輸入${o.label}`},null,8,Yt)),[[g,f.value[o.key]]]):o.type==="date"?y((u(),r("input",{key:1,type:"date",class:"form-control","onUpdate:modelValue":i=>f.value[o.key]=i},null,8,Zt)),[[g,f.value[o.key]]]):o.type==="number"?y((u(),r("input",{key:2,type:"number",class:"form-control","onUpdate:modelValue":i=>f.value[o.key]=i,placeholder:`請輸入${o.label}`,step:"0.01"},null,8,ea)),[[g,f.value[o.key]]]):o.type==="textarea"?y((u(),r("textarea",{key:3,class:"form-control",rows:"3","onUpdate:modelValue":i=>f.value[o.key]=i,placeholder:`請輸入${o.label}`},null,8,ta)),[[g,f.value[o.key]]]):I("",!0)]))),128))])):I("",!0)])):I("",!0)]}),_:1},8,["show","title","icon","is-loading"])],64)}}}),la=ge(aa,[["__scopeId","data-v-b8125db7"]]);export{la as default};
