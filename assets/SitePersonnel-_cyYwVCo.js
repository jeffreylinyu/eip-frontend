import{d as Q,E as q,r as w,k as L,c as y,e as l,f as o,i as f,l as e,m as c,v as t,L as G,z as p,s as i,F as k,y as A,p as g,_ as U}from"./index-DpB6-9r-.js";import{f as $}from"./format-DXaH7iKE.js";const D={class:"site-personnel-project"},z={class:"row mb-4"},H={class:"col-12"},W={class:"alert alert-info",role:"alert"},J={class:"d-flex align-items-center mb-2"},K={class:"badge border border-success text-success px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center ms-2"},X={class:"row"},Z={class:"col-md-6"},ee={class:"mb-0"},se={key:0,class:"badge border border-success text-success px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center ms-2"},te={key:0,class:"badge border border-success text-success px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center ms-2"},ne={key:0,class:"badge border border-success text-success px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center ms-2"},le={class:"col-md-6"},oe={class:"mb-0"},ie={key:0,class:"badge border border-success text-success px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center ms-2"},ae={key:0,class:"badge border border-success text-success px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center ms-2"},re={key:0,class:"row mb-4"},de={class:"col-12"},ce={class:"alert alert-warning",role:"alert"},ue={class:"mb-2"},pe={class:"mb-0"},me={class:"badge border border-warning text-warning px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center ms-2"},fe={class:"row"},xe={class:"col-12"},be={class:"row mb-3"},_e={class:"col-12"},ge={class:"d-flex align-items-center justify-content-between"},ve={class:"d-flex align-items-center gap-4"},ye={class:"badge border border-primary text-primary px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center"},Ee={class:"badge border border-success text-success px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center"},Ce={class:"badge border border-danger text-danger px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center"},Ne={class:"badge border border-info text-info px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center"},he={class:"badge border border-success text-success px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center"},ke={class:"badge border border-warning text-warning px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center"},Ae={class:"text-muted"},Ie={key:0,class:"text-center py-5"},Te={key:1},Oe={class:"row mb-3"},Pe={class:"col-12"},we={class:"d-flex align-items-center"},Le={class:"mb-0"},Re={class:"text-muted mb-0 small"},Fe={class:"ms-auto"},Se={class:"badge border border-primary text-primary px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center"},Ve={class:"row"},je={class:"person-info"},Ye={class:"d-flex align-items-center justify-content-between mb-1"},Be={class:"person-name mb-0"},Me={class:"mb-1"},Qe={key:0,class:"text-muted small"},qe={class:"mb-1"},Ge={class:"text-muted small"},Ue={class:"d-flex align-items-center justify-content-between"},$e={key:0,class:"text-muted small"},De={class:"person-actions d-flex gap-1"},ze=["onClick"],He=["onClick"],We={key:0,class:"col-lg-3 col-md-4 col-sm-6 mb-3"},Je={class:"text-muted mb-1 fs-14px"},Ke={class:"text-muted small mb-0 fs-10px text-center"},Xe=Q({__name:"SitePersonnel",setup(Ze){const R=q(),I=[{key:"QUALITY_CONTROL",name:"品管人員",icon:"fa-medal",color:"warning",description:"負責工程品質管控與檢測作業"},{key:"SAFETY_OFFICER",name:"勞安人員",icon:"fa-shield-alt",color:"danger",description:"負責工地安全檢查與事故預防"},{key:"PROFESSIONAL_ENGINEER",name:"專業技師",icon:"fa-user-tie",color:"info",description:"負責專業技術指導與監督"}],E=w([{personnelId:"1",name:"張品質",email:"quality@example.com",phone:"0912-345-678",idNumber:"A123456789",position:"QUALITY_CONTROL",licenseNumber:"QC-2024-001",status:"ACTIVE",photo:"./assets/img/user/user-6.jpg",certificatePdf:"https://example.com/certificates/qc-2024-001.pdf"},{personnelId:"2",name:"李安全",email:"safety@example.com",phone:"0923-456-789",idNumber:"B987654321",position:"SAFETY_OFFICER",licenseNumber:"SF-2024-002",status:"ACTIVE",photo:"./assets/img/user/profile.jpg",certificatePdf:"https://example.com/certificates/sf-2024-002.pdf"},{personnelId:"3",name:"王技師",email:"engineer@example.com",phone:"0934-567-890",idNumber:"C456789123",position:"PROFESSIONAL_ENGINEER",licenseNumber:"ENG-2024-003",status:"ACTIVE"},{personnelId:"4",name:"陳品管",email:"qc.chen@example.com",phone:"0945-678-901",idNumber:"D111222333",position:"QUALITY_CONTROL",licenseNumber:"QC-2024-004",status:"ON_LEAVE"},{personnelId:"5",name:"劉安全",email:"safety.liu@example.com",phone:"0956-789-012",idNumber:"E444555666",position:"SAFETY_OFFICER",licenseNumber:"SF-2024-005",status:"ACTIVE"}]),m=w([E.value[0],E.value[1]]),C=L(()=>m.value.length),F=L(()=>E.value.filter(n=>n.status==="ACTIVE").length),N=n=>m.value.filter(s=>s.position===n).length,T=n=>m.value.filter(s=>s.status===n).length,v=n=>m.value.filter(s=>s.position===n),S=n=>({ACTIVE:"在職",ON_LEAVE:"休假",TERMINATED:"離職"})[n]||n,V=(n,s=!1)=>`${s?"badge border px-1 py-0 fs-10px":"badge border px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center"} ${{ACTIVE:"border-success text-success",ON_LEAVE:"border-warning text-warning",TERMINATED:"border-danger text-danger"}[n]||"border-secondary text-secondary"}`,h=()=>{R.push("/company/site-personnel")},j=n=>{const s=m.value.findIndex(u=>u.personnelId===n.personnelId);s>-1&&m.value.splice(s,1)},Y=n=>{n.certificatePdf&&window.open(n.certificatePdf,"_blank")},B=()=>3e7,O=()=>"A2 (3000萬～1億元)",d=n=>O().startsWith(n),P=()=>{const n=[];let s={};return s={QUALITY_CONTROL:2,SAFETY_OFFICER:2,PROFESSIONAL_ENGINEER:1},I.forEach(u=>{const x=s[u.key]||0,b=v(u.key).length,_=Math.max(0,x-b);_>0&&n.push({role:u.key,roleName:u.name,required:x,current:b,missing:_})}),n};return(n,s)=>{const u=y("PageHeader"),x=y("card-header"),b=y("card-body"),_=y("card");return o(),l("div",D,[f(u,{title:"專案工地人員管理",icon:"fa fa-users",breadcrumbs:[{text:"基本資料管理",href:"javascript:;"},{text:"工地人員管理",active:!0}]}),e("div",z,[e("div",H,[e("div",W,[e("div",J,[s[0]||(s[0]=e("i",{class:"fa fa-info-circle me-2"},null,-1)),s[1]||(s[1]=e("strong",null,"人員配置建議",-1)),e("span",K," 目前專案金額："+t(G($)(B())),1)]),e("div",X,[e("div",Z,[e("ul",ee,[e("li",{class:p({"current-level":d("A5")})},[s[3]||(s[3]=e("strong",null,"500萬以下：",-1)),s[4]||(s[4]=i("建議配置 1 名品管人員、1 名乙級勞安人員 ")),d("A5")?(o(),l("span",se,s[2]||(s[2]=[e("i",{class:"fa fa-check me-1"},null,-1),i("目前專案 ")]))):c("",!0)],2),e("li",{class:p({"current-level":d("A4")})},[s[6]||(s[6]=e("strong",null,"500萬～1000萬：",-1)),s[7]||(s[7]=i("建議配置 1 名品管人員、1 名乙級勞安人員 ")),d("A4")?(o(),l("span",te,s[5]||(s[5]=[e("i",{class:"fa fa-check me-1"},null,-1),i("目前專案 ")]))):c("",!0)],2),e("li",{class:p({"current-level":d("A3")})},[s[9]||(s[9]=e("strong",null,"1000萬～3000萬：",-1)),s[10]||(s[10]=i("建議配置 1 名品管人員、1 名甲級勞安人員 ")),d("A3")?(o(),l("span",ne,s[8]||(s[8]=[e("i",{class:"fa fa-check me-1"},null,-1),i("目前專案 ")]))):c("",!0)],2)])]),e("div",le,[e("ul",oe,[e("li",{class:p({"current-level":d("A2")})},[s[12]||(s[12]=e("strong",null,"3000萬～1億元：",-1)),s[13]||(s[13]=i("建議配置 2 名品管人員、1 名甲級與 1 名乙級勞安人員 ")),d("A2")?(o(),l("span",ie,s[11]||(s[11]=[e("i",{class:"fa fa-check me-1"},null,-1),i("目前專案 ")]))):c("",!0)],2),e("li",{class:p({"current-level":d("A1")})},[s[15]||(s[15]=e("strong",null,"1億元以上：",-1)),s[16]||(s[16]=i("建議配置 3 名以上品管人員、至少 2 名甲級勞安人員 ")),d("A1")?(o(),l("span",ae,s[14]||(s[14]=[e("i",{class:"fa fa-check me-1"},null,-1),i("目前專案 ")]))):c("",!0)],2)])])])])])]),P().length>0?(o(),l("div",re,[e("div",de,[e("div",ce,[s[17]||(s[17]=e("div",{class:"d-flex align-items-center mb-2"},[e("i",{class:"fa fa-exclamation-triangle me-2"}),e("strong",null,"缺少必要人員")],-1)),e("p",ue,"根據"+t(O())+"的配置建議，目前缺少以下人員：",1),e("ul",pe,[(o(!0),l(k,null,A(P(),a=>(o(),l("li",{key:a.role},[e("strong",null,t(a.roleName)+"：",1),i(" 需要 "+t(a.required)+" 名，目前 "+t(a.current)+" 名 ",1),e("span",me," 缺少 "+t(a.missing)+" 名 ",1)]))),128))])])])])):c("",!0),e("div",fe,[e("div",xe,[f(_,null,{default:g(()=>[f(x,null,{default:g(()=>[e("div",{class:"d-flex justify-content-between align-items-center"},[s[19]||(s[19]=e("div",null,[e("h5",{class:"mb-0"},[e("i",{class:"fa fa-users me-2"}),i(" 專案人員配置 ")])],-1)),e("button",{type:"button",class:"btn btn-theme",onClick:h},s[18]||(s[18]=[e("i",{class:"fa fa-users me-2"},null,-1),i("管理人員 ")]))])]),_:1}),f(b,null,{default:g(()=>[e("div",be,[e("div",_e,[e("div",ge,[e("div",ve,[s[20]||(s[20]=e("span",{class:"text-muted"},"總計：",-1)),e("span",ye,t(C.value)+" 人",1),e("span",Ee,t(N("QUALITY_CONTROL"))+" 品管",1),e("span",Ce,t(N("SAFETY_OFFICER"))+" 勞安",1),e("span",Ne,t(N("PROFESSIONAL_ENGINEER"))+" 技師",1),s[21]||(s[21]=e("span",{class:"text-muted ms-3"},"狀態：",-1)),e("span",he,t(T("ACTIVE"))+" 在職",1),e("span",ke,t(T("ON_LEAVE"))+" 休假",1)]),e("small",Ae,"顯示 "+t(C.value)+" / "+t(F.value)+" 人",1)])])]),C.value===0?(o(),l("div",Ie,[s[23]||(s[23]=e("i",{class:"fa fa-users text-muted fa-3x mb-3"},null,-1)),s[24]||(s[24]=e("h5",{class:"text-muted"},"尚未指派任何人員",-1)),s[25]||(s[25]=e("p",{class:"text-muted"},"請點擊「指派人員」按鈕從公司人員中選擇",-1)),e("button",{type:"button",class:"btn btn-outline-theme",onClick:h},s[22]||(s[22]=[e("i",{class:"fa fa-users me-2"},null,-1),i("管理人員 ")]))])):(o(),l("div",Te,[(o(),l(k,null,A(I,a=>e("div",{key:a.key,class:"mb-4"},[e("div",Oe,[e("div",Pe,[e("div",we,[e("div",{class:p(["widget-icon rounded me-3",`bg-${a.color}`])},[e("i",{class:p(["fa",a.icon]),style:{color:"white"}},null,2)],2),e("div",null,[e("h6",Le,t(a.name),1),e("p",Re,t(a.description),1)]),e("div",Fe,[e("span",Se,t(v(a.key).length)+" 人 ",1)])])])]),e("div",Ve,[(o(!0),l(k,null,A(v(a.key),r=>(o(),l("div",{key:r.personnelId,class:"col-lg-3 col-md-4 col-sm-6 mb-3"},[f(_,{class:"person-card h-100"},{default:g(()=>[f(b,{class:"p-3"},{default:g(()=>[e("div",je,[e("div",Ye,[e("h6",Be,t(r.name),1),e("span",{class:p(V(r.status))},t(S(r.status)),3)]),e("div",Me,[r.licenseNumber?(o(),l("span",Qe,[s[26]||(s[26]=e("i",{class:"fa fa-certificate me-1"},null,-1)),i(t(r.licenseNumber),1)])):c("",!0)]),e("div",qe,[e("span",Ge,[s[27]||(s[27]=e("i",{class:"fa fa-id-card me-1"},null,-1)),i(t(r.idNumber),1)])]),e("div",Ue,[r.phone?(o(),l("span",$e,[s[28]||(s[28]=e("i",{class:"fa fa-phone me-1"},null,-1)),i(t(r.phone),1)])):c("",!0),e("div",De,[r.certificatePdf?(o(),l("button",{key:0,type:"button",class:"btn btn-sm btn-outline-primary",onClick:M=>Y(r),title:"查看證照"},s[29]||(s[29]=[e("i",{class:"fa fa-file-pdf"},null,-1)]),8,ze)):c("",!0),e("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:M=>j(r),title:"移除指派"},s[30]||(s[30]=[e("i",{class:"fa fa-times"},null,-1)]),8,He)])])])]),_:2},1024)]),_:2},1024)]))),128))]),v(a.key).length===0?(o(),l("div",We,[e("div",{class:"empty-state-small clickable-empty",onClick:h},[s[31]||(s[31]=e("div",{class:"empty-icon-small mb-2"},[e("i",{class:"fa fa-users"})],-1)),e("h6",Je,"暫無"+t(a.name),1),e("p",Ke,"點擊指派"+t(a.name)+"來管理此職務",1)])])):c("",!0)])),64))]))]),_:1})]),_:1})])])])}}}),ts=U(Xe,[["__scopeId","data-v-5fd6481b"]]);export{ts as default};
