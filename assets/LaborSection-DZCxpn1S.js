import{d as J,E as O,r as L,k as i,a as Q,e as d,f as c,l as t,i as n,s as p,p as a,q as x,x as f,m as M,F as w,y as W,I as b,v as u,Q as Y,J as v,C as g,S as V,_ as G}from"./index-CB9Z8Gmd.js";import{L as K}from"./dailyReport-CO5OWQqK.js";const X={class:"labor-section"},Z={class:"table-responsive"},tt={class:"table table-bordered table-hover"},lt=["onUpdate:modelValue"],st=["value"],et=["onUpdate:modelValue"],ot={class:"input-group"},nt=["onUpdate:modelValue"],at={class:"input-group"},ut=["onUpdate:modelValue"],rt={class:"input-group"},it=["onUpdate:modelValue"],dt={class:"input-group"},ct=["onUpdate:modelValue"],mt={class:"input-group"},pt=["onUpdate:modelValue"],bt={class:"text-center"},vt={class:"badge bg-primary fs-6"},ft={class:"input-group"},gt=["onUpdate:modelValue"],_t=["onUpdate:modelValue"],ht=["onClick"],yt={key:0},kt={class:"table-secondary"},xt={class:"row mt-4"},wt={class:"col-md-3"},Wt={class:"mb-1"},Vt={class:"col-md-3"},Tt={class:"mb-1"},Ut={class:"col-md-3"},Ct={class:"mb-1"},St={class:"col-md-3"},Lt={class:"mb-1"},Mt={class:"row mt-4"},Rt={class:"col-md-6"},Bt={class:"d-flex justify-content-between mb-2"},jt={class:"badge bg-primary"},Nt={class:"progress mb-3",style:{height:"8px"}},Pt={class:"d-flex justify-content-between mb-2"},Et={class:"badge bg-success"},Ft={class:"progress mb-3",style:{height:"8px"}},qt={class:"d-flex justify-content-between mb-2"},At={class:"badge bg-warning"},Dt={class:"progress mb-3",style:{height:"8px"}},It={class:"col-md-6"},$t={key:0,class:"text-center text-muted"},zt={key:1,class:"list-unstyled mb-0"},Ht={class:"d-flex justify-content-between mt-4"},Jt={class:"d-flex gap-2"},Ot=["disabled"],Qt=["disabled"],Yt=J({__name:"LaborSection",setup(Gt){const T=O(),r=L([]),k=L(!1),R=i(()=>K),B=i(()=>r.value.reduce((s,l)=>s+(l.structuralWork||0),0)),j=i(()=>r.value.reduce((s,l)=>s+(l.laborWork||0),0)),h=i(()=>r.value.reduce((s,l)=>s+(l.morning||0),0)),y=i(()=>r.value.reduce((s,l)=>s+(l.afternoon||0),0)),_=i(()=>r.value.reduce((s,l)=>s+(l.night||0),0)),m=i(()=>h.value+y.value+_.value),U=i(()=>r.value.reduce((s,l)=>s+(l.cumulative||0),0)),N=i(()=>{const s=[h.value,y.value,_.value].filter(l=>l>0);return s.length>0?Math.round(m.value/s.length):0}),P=i(()=>m.value>0?Math.round(h.value/m.value*100):0),E=i(()=>m.value>0?Math.round(y.value/m.value*100):0),F=i(()=>m.value>0?Math.round(_.value/m.value*100):0),C=i(()=>{const s=[];return _.value>10&&s.push("夜間班人數過多，請確認是否正確"),r.value.forEach((l,e)=>{l.laborType||s.push(`第${e+1}行工種未選擇`)}),m.value>100&&s.push("本日出工總人數超過100人，請確認是否正確"),s}),q=s=>(s.morning||0)+(s.afternoon||0)+(s.night||0),A=()=>{r.value.push({laborType:"",structuralWork:0,laborWork:0,morning:0,afternoon:0,night:0,cumulative:0,remarks:""})},D=s=>{r.value.splice(s,1)},I=()=>{const s=[{laborType:"結構工",structuralWork:0,laborWork:0,morning:0,afternoon:0,night:0,cumulative:0,remarks:""},{laborType:"口工",structuralWork:0,laborWork:0,morning:0,afternoon:0,night:0,cumulative:0,remarks:""},{laborType:"鋼筋工",structuralWork:0,laborWork:0,morning:0,afternoon:0,night:0,cumulative:0,remarks:""},{laborType:"模板工",structuralWork:0,laborWork:0,morning:0,afternoon:0,night:0,cumulative:0,remarks:""},{laborType:"混凝土工",structuralWork:0,laborWork:0,morning:0,afternoon:0,night:0,cumulative:0,remarks:""},{laborType:"水電工",structuralWork:0,laborWork:0,morning:0,afternoon:0,night:0,cumulative:0,remarks:""},{laborType:"雜工",structuralWork:0,laborWork:0,morning:0,afternoon:0,night:0,cumulative:0,remarks:""}];r.value=[...r.value,...s]},$=async()=>{k.value=!0,k.value=!1},z=()=>{T.push("/daily-report/materials")},H=()=>{T.push("/daily-report/equipment")};return Q(()=>{}),(s,l)=>(c(),d("div",X,[t("div",{class:"d-flex justify-content-between align-items-center mb-4"},[l[2]||(l[2]=t("div",null,[t("h4",{class:"mb-1"},"出工紀錄"),t("p",{class:"text-muted mb-0"},"管理各工種的出工人數統計")],-1)),t("div",{class:"d-flex gap-2"},[t("button",{class:"btn btn-outline-primary",onClick:A},l[0]||(l[0]=[t("i",{class:"fa fa-plus me-1"},null,-1),p("新增工種 ")])),t("button",{class:"btn btn-outline-secondary",onClick:I},l[1]||(l[1]=[t("i",{class:"fa fa-download me-1"},null,-1),p("匯入範本 ")]))])]),n(g,null,{default:a(()=>[n(x,null,{default:a(()=>l[3]||(l[3]=[t("h6",{class:"mb-0"},[t("i",{class:"fa fa-users me-2"}),p("出工紀錄表 ")],-1)])),_:1,__:[3]}),n(f,null,{default:a(()=>[t("div",Z,[t("table",tt,[l[17]||(l[17]=t("thead",{class:"table-light"},[t("tr",null,[t("th",{style:{width:"20%"}},"工種名稱"),t("th",{style:{width:"10%"}},"結構工"),t("th",{style:{width:"10%"}},"口工"),t("th",{style:{width:"10%"}},"上午"),t("th",{style:{width:"10%"}},"下午"),t("th",{style:{width:"10%"}},"夜間"),t("th",{style:{width:"10%"}},"本日小計"),t("th",{style:{width:"10%"}},"累計"),t("th",{style:{width:"10%"}},"備註"),t("th",{style:{width:"5%"}},"操作")])],-1)),t("tbody",null,[(c(!0),d(w,null,W(r.value,(e,S)=>(c(),d("tr",{key:e.id||S},[t("td",null,[b(t("select",{class:"form-select","onUpdate:modelValue":o=>e.laborType=o},[l[4]||(l[4]=t("option",{value:""},"請選擇工種",-1)),(c(!0),d(w,null,W(R.value,o=>(c(),d("option",{key:o,value:o},u(o),9,st))),128)),l[5]||(l[5]=t("option",{value:"custom"},"其他（自訂）",-1))],8,lt),[[Y,e.laborType]]),e.laborType==="custom"?b((c(),d("input",{key:0,type:"text",class:"form-control mt-1","onUpdate:modelValue":o=>e.customType=o,placeholder:"請輸入工種名稱"},null,8,et)),[[v,e.customType]]):M("",!0)]),t("td",null,[t("div",ot,[b(t("input",{type:"number",class:"form-control","onUpdate:modelValue":o=>e.structuralWork=o,min:"0",placeholder:"0"},null,8,nt),[[v,e.structuralWork]]),l[6]||(l[6]=t("span",{class:"input-group-text"},"人",-1))])]),t("td",null,[t("div",at,[b(t("input",{type:"number",class:"form-control","onUpdate:modelValue":o=>e.laborWork=o,min:"0",placeholder:"0"},null,8,ut),[[v,e.laborWork]]),l[7]||(l[7]=t("span",{class:"input-group-text"},"人",-1))])]),t("td",null,[t("div",rt,[b(t("input",{type:"number",class:"form-control","onUpdate:modelValue":o=>e.morning=o,min:"0",placeholder:"0"},null,8,it),[[v,e.morning]]),l[8]||(l[8]=t("span",{class:"input-group-text"},"人",-1))])]),t("td",null,[t("div",dt,[b(t("input",{type:"number",class:"form-control","onUpdate:modelValue":o=>e.afternoon=o,min:"0",placeholder:"0"},null,8,ct),[[v,e.afternoon]]),l[9]||(l[9]=t("span",{class:"input-group-text"},"人",-1))])]),t("td",null,[t("div",mt,[b(t("input",{type:"number",class:"form-control","onUpdate:modelValue":o=>e.night=o,min:"0",placeholder:"0"},null,8,pt),[[v,e.night]]),l[10]||(l[10]=t("span",{class:"input-group-text"},"人",-1))])]),t("td",null,[t("div",bt,[t("span",vt,u(q(e)),1)])]),t("td",null,[t("div",ft,[b(t("input",{type:"number",class:"form-control","onUpdate:modelValue":o=>e.cumulative=o,min:"0",placeholder:"0"},null,8,gt),[[v,e.cumulative]]),l[11]||(l[11]=t("span",{class:"input-group-text"},"人",-1))])]),t("td",null,[b(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o=>e.remarks=o,placeholder:"備註"},null,8,_t),[[v,e.remarks]])]),t("td",null,[t("button",{class:"btn btn-sm btn-outline-danger",onClick:o=>D(S),title:"刪除"},l[12]||(l[12]=[t("i",{class:"fa fa-trash"},null,-1)]),8,ht)])]))),128)),r.value.length===0?(c(),d("tr",yt,l[13]||(l[13]=[t("td",{colspan:"10",class:"text-center text-muted py-4"},[t("i",{class:"fa fa-users fa-2x mb-2"}),t("p",{class:"mb-0"},"尚未新增任何出工紀錄")],-1)]))):M("",!0)]),t("tfoot",kt,[t("tr",null,[l[14]||(l[14]=t("td",null,[t("strong",null,"總計")],-1)),t("td",null,[t("strong",null,u(B.value),1)]),t("td",null,[t("strong",null,u(j.value),1)]),t("td",null,[t("strong",null,u(h.value),1)]),t("td",null,[t("strong",null,u(y.value),1)]),t("td",null,[t("strong",null,u(_.value),1)]),t("td",null,[t("strong",null,u(m.value),1)]),t("td",null,[t("strong",null,u(U.value),1)]),l[15]||(l[15]=t("td",null,null,-1)),l[16]||(l[16]=t("td",null,null,-1))])])])])]),_:1})]),_:1}),t("div",xt,[t("div",wt,[n(g,{class:"bg-primary text-white"},{default:a(()=>[n(f,{class:"text-center"},{default:a(()=>[t("h4",Wt,u(r.value.length),1),l[18]||(l[18]=t("p",{class:"mb-0"},"工種數量",-1))]),_:1,__:[18]})]),_:1})]),t("div",Vt,[n(g,{class:"bg-success text-white"},{default:a(()=>[n(f,{class:"text-center"},{default:a(()=>[t("h4",Tt,u(m.value),1),l[19]||(l[19]=t("p",{class:"mb-0"},"本日出工總人數",-1))]),_:1,__:[19]})]),_:1})]),t("div",Ut,[n(g,{class:"bg-warning text-white"},{default:a(()=>[n(f,{class:"text-center"},{default:a(()=>[t("h4",Ct,u(U.value),1),l[20]||(l[20]=t("p",{class:"mb-0"},"累計出工總人數",-1))]),_:1,__:[20]})]),_:1})]),t("div",St,[n(g,{class:"bg-info text-white"},{default:a(()=>[n(f,{class:"text-center"},{default:a(()=>[t("h4",Lt,u(N.value),1),l[21]||(l[21]=t("p",{class:"mb-0"},"平均每班人數",-1))]),_:1,__:[21]})]),_:1})])]),t("div",Mt,[t("div",Rt,[n(g,null,{default:a(()=>[n(x,null,{default:a(()=>l[22]||(l[22]=[t("h6",{class:"mb-0"},[t("i",{class:"fa fa-chart-pie me-2"}),p("班次分析 ")],-1)])),_:1,__:[22]}),n(f,null,{default:a(()=>[t("div",Bt,[l[23]||(l[23]=t("span",null,"上午班",-1)),t("span",jt,u(h.value)+"人",1)]),t("div",Nt,[t("div",{class:"progress-bar bg-primary",style:V({width:P.value+"%"})},null,4)]),t("div",Pt,[l[24]||(l[24]=t("span",null,"下午班",-1)),t("span",Et,u(y.value)+"人",1)]),t("div",Ft,[t("div",{class:"progress-bar bg-success",style:V({width:E.value+"%"})},null,4)]),t("div",qt,[l[25]||(l[25]=t("span",null,"夜間班",-1)),t("span",At,u(_.value)+"人",1)]),t("div",Dt,[t("div",{class:"progress-bar bg-warning",style:V({width:F.value+"%"})},null,4)])]),_:1})]),_:1})]),t("div",It,[n(g,null,{default:a(()=>[n(x,null,{default:a(()=>l[26]||(l[26]=[t("h6",{class:"mb-0"},[t("i",{class:"fa fa-exclamation-triangle me-2"}),p("異常提醒 ")],-1)])),_:1,__:[26]}),n(f,null,{default:a(()=>[C.value.length===0?(c(),d("div",$t,l[27]||(l[27]=[t("i",{class:"fa fa-check-circle fa-2x mb-2 text-success"},null,-1),t("p",{class:"mb-0"},"無異常情況",-1)]))):(c(),d("ul",zt,[(c(!0),d(w,null,W(C.value,e=>(c(),d("li",{key:e,class:"mb-2"},[l[28]||(l[28]=t("i",{class:"fa fa-exclamation-triangle text-warning me-2"},null,-1)),p(" "+u(e),1)]))),128))]))]),_:1})]),_:1})])]),t("div",Ht,[t("button",{class:"btn btn-outline-secondary",onClick:z},l[29]||(l[29]=[t("i",{class:"fa fa-arrow-left me-1"},null,-1),p("返回材料頁面 ")])),t("div",Jt,[t("button",{class:"btn btn-primary",onClick:$,disabled:k.value},l[30]||(l[30]=[t("i",{class:"fa fa-save me-1"},null,-1),p("儲存 ")]),8,Ot),t("button",{class:"btn btn-success",onClick:H,disabled:k.value},l[31]||(l[31]=[p(" 下一步 "),t("i",{class:"fa fa-arrow-right ms-1"},null,-1)]),8,Qt)])])]))}}),Zt=G(Yt,[["__scopeId","data-v-f6b75d65"]]);export{Zt as default};
